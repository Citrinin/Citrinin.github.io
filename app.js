!function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(o)return o(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){var n=t[i][1][e];return a(n||e)},l,l.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,a=e("../utils/request"),o=(r=a,r&&r.__esModule?r:{default:r});var i="AIzaSyB2D-Cmek8ifPd0bHOFzKsdFTofnXBWoIE";n.default=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.eventBus=t,this.eventBus.on("map:clicked",function(e){n.getPlaceName(e.lat,e.lng).then(function(t){n.eventBus.trigger("google:cityFound",t,e)},function(t){var r=prompt("Неизвестное место. Введите название","HollyWood");r&&n.eventBus.trigger("google:cityFound",r,e)})}),this.getLatLng=function(e){return(0,o.default)("https://maps.googleapis.com/maps/api/geocode/json?address="+e+"&key="+i).then(function(e){return e.results[0].geometry.location})},this.getPlaceName=function(e,t){return(0,o.default)("https://maps.googleapis.com/maps/api/geocode/json?latlng="+e+","+t+"&result_type=locality&language=ru&key="+i).then(function(e){return e.results[0].address_components[0].short_name})}}},{"../utils/request":11}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=e("../utils/lsStorage"),i=(r=o,r&&r.__esModule?r:{default:r});var s=function(){function e(t,n,r,a,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxItemAmount=n||0,this.allowRemove=t,this.items={},this.storageName=r,this.htmlElement=a,this.eventBus=o,this.init(),"Favorites"===this.storageName&&this.addRemoval()}return a(e,[{key:"init",value:function(){var e=this;"Favorites"===this.storageName&&this.eventBus.on("google:cityFound",this.addItem.bind(this)),i.default.getData(this.storageName).then(function(t){e.items=JSON.parse(t)||{},e.render()})}},{key:"render",value:function(){this.htmlElement.innerHTML="";var e=document.createElement("ul");for(var t in this.items){var n=document.createElement("li"),r=document.createElement("a");r.href="Favorites"===this.storageName?"#center="+this.items[t].lat+","+this.items[t].lng:"#city="+t,r.innerHTML=t+(this.allowRemove?'<span class="glyphicon glyphicon-remove cross-align-right"/>':""),n.appendChild(r),e.insertBefore(n,e.firstChild)}this.htmlElement.appendChild(e)}},{key:"addRemoval",value:function(){var e=this;this.allowRemove&&this.htmlElement.addEventListener("click",function(t){if(t.target.matches(".glyphicon-remove")){t.preventDefault();var n=t.target.parentElement.innerText;e.eventBus.trigger("list:removeFav",e.items[n]),delete e.items[n],i.default.setData(e.storageName,JSON.stringify(e.items)),e.render()}})}},{key:"addItem",value:function(e,t){void 0===this.items[e]&&(this.items[e]=t||{},"Favorites"===this.storageName&&this.eventBus.trigger("list:addFav",this.items[e]),0!==this.maxItemAmount&&Object.keys(this.items).length>this.maxItemAmount&&delete this.items[Object.keys(this.items)[0]],this.render(),i.default.setData(this.storageName,JSON.stringify(this.items)))}}]),e}();n.default=s},{"../utils/lsStorage":10}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.htmlElement=t,this.eventBus=n,this.init()}return r(e,[{key:"init",value:function(){var e=this;this.render(),this.htmlElement.addEventListener("keypress",function(t){t.target.matches("input")&&13==t.keyCode&&e.goToCity()}),this.htmlElement.addEventListener("click",function(t){t.target.matches("button")&&e.goToCity()})}},{key:"goToCity",value:function(){""!==this.input.value&&(this.eventBus.trigger("search:city",this.input.value),this.input.value="")}},{key:"render",value:function(){this.htmlElement.innerHTML="",this.input=document.createElement("input"),this.input.className="form-control input__city",this.input.placeholder="city",this.htmlElement.appendChild(this.input);var e=document.createElement("span");e.className="input-group-btn";var t=document.createElement("button");t.className="btn btn-default search button__search_city",t.type="button";var n=document.createElement("span");n.className="glyphicon glyphicon-search",t.appendChild(n),e.appendChild(t),this.htmlElement.appendChild(e)}}]),e}();n.default=a},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=i(e("../utils/skycons")),o=i(e("../utils/request"));function i(e){return e&&e.__esModule?e:{default:e}}var s="5031e075946739a76f0e37598086d0a3",u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t,this.eventBus=n}return r(e,[{key:"getForecastByLatLng",value:function(e,t,n){var r=this;this.cityName=n,(0,o.default)("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/"+s+"/"+e+","+t+"?lang=ru&units=si").then(function(e){return e.json()}).then(function(e){r.render(e.daily.data)})}},{key:"getForecastByLatLng",value:function(e,t,n){var r=this;this.cityName=n,(0,o.default)("https://cors-anywhere.herokuapp.com/https://api.darksky.net/forecast/"+s+"/"+e+","+t+"?lang=ru&units=si").then(function(e){r.render(e.daily.data)})}},{key:"render",value:function(e){this.element.innerHTML="";var t=document.createElement("span");t.innerHTML="Place: "+this.cityName,this.element.appendChild(t);var n=document.createElement("table");n.className="weatherTable table";var r=document.createElement("tr"),o=document.createElement("th");o.innerHTML="Date";var i=new Date;r.appendChild(o);for(var s=0;s<7;s++){var u=document.createElement("th");u.innerHTML=i.getDate()+"."+(i.getMonth()+1),r.appendChild(u),i.setDate(i.getDate()+1)}n.appendChild(r),r=document.createElement("tr");var c=document.createElement("th");r.appendChild(c);for(var l=0;l<7;l++){var d=document.createElement("td");d.innerHTML='<canvas class="'+e[l].icon+'" width="30" height="30"></canvas>',r.appendChild(d)}n.appendChild(r),n.appendChild(this.createRow(e,"Day temperature","temperatureHigh")),n.appendChild(this.createRow(e,"Night temperature","temperatureLow")),n.appendChild(this.createRow(e,"Wind speed","windSpeed")),this.element.appendChild(n),(0,a.default)()}},{key:"createRow",value:function(e,t,n){var r=document.createElement("tr"),a=document.createElement("th");a.innerHTML=t,r.appendChild(a);for(var o=0;o<7;o++){var i=document.createElement("td");i.innerHTML=e[o][n],r.appendChild(i)}return r}}]),e}();n.default=u},{"../utils/request":11,"../utils/skycons":13}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=o(e("../utils/debounce")),a=o(e("../utils/lsStorage"));function o(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=s.getCenter();this.eventBus.trigger("map:moved",t[0],t[1])}var s,u={};function c(e,t,n,r){this.startLat=t,this.startLng=n,this.eventBus=e,this.storageName=r,this.init()}c.prototype.moveTo=function(e,t){s.panTo([+e,+t],{duration:2e3})},c.prototype.init=function(){var e=this;ymaps.ready(function(){e.createMap([e.startLat,e.startLng]),a.default.getData(e.storageName).then(function(e){var t=JSON.parse(e)||{};for(var n in t){var r=new ymaps.Placemark([t[n].lat,t[n].lng],{},{preset:"islands#yellowGlyphIcon",iconGlyph:"star"});u[t[n].lat+","+t[n].lng]=r,s.geoObjects.add(r)}}),e.eventBus.on("list:addFav",function(e){var t=new ymaps.Placemark([e.lat,e.lng],{},{preset:"islands#yellowGlyphIcon",iconGlyph:"star"});u[e.lat+","+e.lng]=t,s.geoObjects.add(t)}),e.eventBus.on("list:removeFav",function(e){s.geoObjects.remove(u[e.lat+","+e.lng]),delete u[e.lat+","+e.lng]})})},c.prototype.createMap=function(e){var t=this;(s=new ymaps.Map("map",{center:[e[0],e[1]],zoom:12,controls:["zoomControl"]},{suppressMapOpenBlock:!0})).events.add("click",function(e){var n=e.get("coords"),r={lat:n[0],lng:n[1]};t.eventBus.trigger("map:clicked",r)}),s.events.add("actionend",(0,r.default)(i,700).bind(this))},c.prototype.getCenter=function(){return s.getCenter()},n.default=c},{"../utils/debounce":8,"../utils/lsStorage":10}],6:[function(e,t,n){"use strict";var r=a(e("./routes"));function a(e){return e&&e.__esModule?e:{default:e}}new(a(e("./utils/router")).default)(r.default)},{"./routes":7,"./utils/router":12}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=d(e("./components/listComponent")),a=d(e("./components/googleSearch")),o=d(e("./components/yandexMap")),i=d(e("./components/weatherForecast")),s=d(e("./utils/eventBus")),u=d(e("./utils/userLocation")),c=d(e("./utils/request")),l=d(e("./components/searchComponent"));function d(e){return e&&e.__esModule?e:{default:e}}function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}document.querySelector(".myradio").addEventListener("click",function(e){c.default.type=document.querySelector('input[name="request__option"]:checked').value});var f=void 0,m=void 0,p=void 0,v=void 0,y=void 0,g=document.querySelector("#map"),w=document.querySelector("#weather"),_=[{match:"",onEnter:function(){u.default.then(function(e){window.location.hash=e.latitude+","+e.longitude})}},{match:/city=(.+)/,onEnter:function(e){E()?(v.addItem(decodeURI(e)),m.getLatLng(e).then(function(e){p.moveTo(e.lat,e.lng)})):(L(e),v.addItem(decodeURI(e)),m.getLatLng(e).then(function(e){window.location.hash=e.lat+","+e.lng}))}},{match:/^([+|-]?\d*\.?\d+)\,([+|-]?\d*\.?\d+)/,onEnter:function(e){var t;E()||L.apply(void 0,h(e)),(t=m).getPlaceName.apply(t,h(e)).then(function(t){var n;return(n=y).getForecastByLatLng.apply(n,h(e).concat([t]))}).catch(function(t){var n;return(n=y).getForecastByLatLng.apply(n,h(e).concat(["Unknown place"]))})}},{match:/center=([+|-]?\d*\.?\d+)\,([+|-]?\d*\.?\d+)/,onBeforeEnter:function(e){var t;return E()?(t=p).moveTo.apply(t,h(e)):L.apply(void 0,h(e))}},{match:"author",onEnter:function(){b(),w.hidden="true",document.querySelector(".active").className="",document.querySelector('[href="#author"]').parentElement.className="active",g.innerHTML="<h2>Author - Kate Kuzkina</h2>"}},{match:"about",onEnter:function(){b(),w.hidden="true",document.querySelector(".active").className="",document.querySelector('[href="#about"]').parentElement.className="active",g.innerHTML="<h2>Wezzard is the best weather site ever</h2>"}}];function E(){return!!(v&&m&&p&&y)}function b(){f=null,m=null,p=null,null,v=null,y=null,null}function L(e,t){w.removeAttribute("hidden"),g.innerHTML="",document.querySelector(".active").className="",document.querySelector('li [href="#"]').parentElement.className="active",f=new s.default,m=new a.default(f),Number.isNaN(+e)?m.getLatLng(e).then(function(e){p=new o.default(f,e.lat,e.lng,"Favorites")}):p=new o.default(f,e,t,"Favorites"),new r.default(!0,0,"Favorites",document.querySelector(".favorites__list"),f),v=new r.default(!1,5,"History",document.querySelector(".history__list")),y=new i.default(document.querySelector(".weather__forecast"),f),new l.default(document.querySelector(".input-group"),f),f.on("search:city",function(e){window.location.hash="city="+e}),f.on("map:moved",function(e,t){window.location.hash=e+","+t})}n.default=_},{"./components/googleSearch":1,"./components/listComponent":2,"./components/searchComponent":3,"./components/weatherForecast":4,"./components/yandexMap":5,"./utils/eventBus":9,"./utils/request":11,"./utils/userLocation":14}],8:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=function(e,t){var n;return function(){var r=this,a=arguments;clearTimeout(n),n=setTimeout(function(){return e.apply(r,a)},t)}}},{}],9:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});function r(){this.listeners={}}r.prototype.trigger=function(e){for(var t=0;t<(this.listeners[e]||[]).length;t++){var n=this.listeners[e][t];if("function"==typeof n){var r=[].slice.call(arguments,1);n.apply(null,r),-1!==n.toString().indexOf("self.off")&&t--}}},r.prototype.on=function(e,t){this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(t)},r.prototype.off=function(e,t){if(void 0!=this.listeners[e]){var n=this.listeners[e].indexOf(t);this.listeners[e].splice(n,1)}},r.prototype.once=function(e,t){var n=this;n.on(e,function r(){t.apply(null,arguments),n.off(e,r)})},n.default=r},{}],10:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r={getData:function(e){return Promise.resolve(window.localStorage.getItem(e))},setData:function(e,t){return Promise.resolve(window.localStorage.setItem(e,t))}};n.default=r},{}],11:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});function r(e){return"XHR"===r.type?(t=e,new Promise(function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.onload=function(){this.status>=200&&this.status<300?e(JSON.parse(r.response)):n({status:this.status,statusText:r.statusText})},r.onerror=function(){n({status:this.status,statusText:r.statusText})},r.send()})):fetch(e).then(function(e){return e.json()});var t}r.type="XHR";n.default=r},{}],12:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});function r(e){var t=this;this.routes=e||[],this.currentRoute,this.previousRoute,this.currentParams,this.previousParams,window.addEventListener("hashchange",function(e){t.handler(window.location.hash)}),this.handler(window.location.hash)}r.prototype={handler:function(e){this.previousRoute=this.currentRoute,this.previousParams=this.currentParams,this.currentRoute=this.findNewRoute(e),this.launchHandlers()},findNewRoute:function(e){e=e.slice(1);for(var t=0;t<this.routes.length;t++){var n=this.routes[t];if("string"==typeof n.match&&n.match===e)return this.currentParams="",n;if("function"==typeof n.match&&n.match(e))return this.currentParams="",n;if(n.match instanceof RegExp&&n.match.test(e))return this.currentParams=e.match(n.match)||[],this.currentParams.splice(0,1),n}},launchHandlers:function(){var e=this;Promise.resolve().then(function(){e.previousRoute&&e.previousRoute.onLeave&&e.previousRoute.onLeave(e.previousParams)}).then(function(){e.currentRoute&&e.currentRoute.onBeforeEnter&&e.currentRoute.onBeforeEnter(e.currentParams)}).then(function(){e.currentRoute&&e.currentRoute.onEnter&&e.currentRoute.onEnter(e.currentParams)})}},n.default=r},{}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){for(var e=document.querySelectorAll("canvas"),t=0;t<e.length;t++)r.set(e[t],Skycons[e[t].className.toUpperCase().replace(/-/g,"_")])};var r=new Skycons;!function(){for(var e=document.querySelectorAll("canvas"),t=0;t<e.length;t++)r.add(e[t],Skycons[e[t].className.toUpperCase().replace(/-/g,"_")]);r.play()}()},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r,a=e("./request");var o=(0,(r=a,r&&r.__esModule?r:{default:r}).default)("https://api.userinfo.io/userinfos").then(function(e){return e.position});n.default=o},{"./request":11}]},{},[6]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvY29tcG9uZW50cy9nb29nbGVTZWFyY2guanMiLCJzcmMvanMvY29tcG9uZW50cy9saXN0Q29tcG9uZW50LmpzIiwic3JjL2pzL2NvbXBvbmVudHMvc2VhcmNoQ29tcG9uZW50LmpzIiwic3JjL2pzL2NvbXBvbmVudHMvd2VhdGhlckZvcmVjYXN0LmpzIiwic3JjL2pzL2NvbXBvbmVudHMveWFuZGV4TWFwLmpzIiwic3JjL2pzL21haW4uanMiLCJzcmMvanMvcm91dGVzLmpzIiwic3JjL2pzL3V0aWxzL2RlYm91bmNlLmpzIiwic3JjL2pzL3V0aWxzL2V2ZW50QnVzLmpzIiwic3JjL2pzL3V0aWxzL2xzU3RvcmFnZS5qcyIsInNyYy9qcy91dGlscy9yZXF1ZXN0LmpzIiwic3JjL2pzL3V0aWxzL3JvdXRlci5qcyIsInNyYy9qcy91dGlscy9za3ljb25zLmpzIiwic3JjL2pzL3V0aWxzL3VzZXJMb2NhdGlvbi5qcyJdLCJuYW1lcyI6WyJlIiwidCIsIm4iLCJyIiwicyIsIm8iLCJ1IiwiYSIsInJlcXVpcmUiLCJpIiwiZiIsIkVycm9yIiwiY29kZSIsImwiLCJleHBvcnRzIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJtb2R1bGUiLCJfcmVxdWVzdCIsIkdPT0dMRV9BUElfS0VZIiwiR29vZ2xlTWFwIiwiZXZlbnRCdXMiLCJ0aGlzIiwib24iLCJvYmoiLCJnZXRQbGFjZU5hbWUiLCJsYXQiLCJsbmciLCJ0aGVuIiwiY2l0eU5hbWUiLCJ0cmlnZ2VyIiwiZXJyIiwicHJvbXB0IiwiZ2V0TGF0TG5nIiwiYWRkciIsImRhdGEiLCJyZXN1bHRzIiwiZ2VvbWV0cnkiLCJsb2NhdGlvbiIsImFkZHJlc3NfY29tcG9uZW50cyIsInNob3J0X25hbWUiLCJfbHNTdG9yYWdlIiwiTGlzdENvbXBvbmVudCIsImFsbG93UmVtb3ZlIiwibWF4SXRlbUFtb3VudCIsInN0b3JhZ2VOYW1lIiwiaHRtbEVsZW1lbnQiLCJpdGVtcyIsImluaXQiLCJhZGRSZW1vdmFsIiwiYWRkSXRlbSIsImJpbmQiLCJnZXREYXRhIiwicmVzdWx0IiwiSlNPTiIsInBhcnNlIiwicmVuZGVyIiwiaW5uZXJIVE1MIiwidWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJrZXkiLCJsaSIsImhyZWYiLCJhcHBlbmRDaGlsZCIsImluc2VydEJlZm9yZSIsImZpcnN0Q2hpbGQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXYiLCJ0YXJnZXQiLCJtYXRjaGVzIiwicHJldmVudERlZmF1bHQiLCJwYXJlbnRFbGVtZW50IiwiaW5uZXJUZXh0IiwiX3RoaXMyIiwic2V0RGF0YSIsInN0cmluZ2lmeSIsInVuZGVmaW5lZCIsIk9iamVjdCIsImtleXMiLCJTZWFyY2hDb21wb25lbnQiLCJldmVudCIsImtleUNvZGUiLCJnb1RvQ2l0eSIsImlucHV0IiwidmFsdWUiLCJjbGFzc05hbWUiLCJwbGFjZWhvbGRlciIsInNwYW4iLCJidG4iLCJ0eXBlIiwic3BhblNlYXJjaCIsIldlYXRoZXJGb3JlY2FzdCIsIl9lbGVtZW50IiwiZWxlbWVudCIsInJlcSIsImpzb24iLCJkYWlseSIsImRhaWx5Rm9yZWNhc3QiLCJoZWFkZXIiLCJ0YWJsZSIsInRyIiwidGhIZWFkZXIiLCJkYXRlIiwiRGF0ZSIsImluZGV4IiwidGgiLCJnZXREYXRlIiwiZ2V0TW9udGgiLCJzZXREYXRlIiwidGRIZWFkZXIiLCJfaW5kZXgiLCJ0ZCIsImljb24iLCJjcmVhdGVSb3ciLCJkZWZhdWx0Iiwic291cmNlIiwicm93SGVhZGVyIiwicm93Q29udGVudCIsImV2SGFuZGxlciIsImNvb3JkcyIsIm15TWFwIiwiZ2V0Q2VudGVyIiwicGxhY2VtYXJrcyIsIllhbmRleE1hcCIsInN0YXJ0TGF0Iiwic3RhcnRMbmciLCJwcm90b3R5cGUiLCJtb3ZlVG8iLCJwYW5UbyIsImR1cmF0aW9uIiwicmVhZHkiLCJjcmVhdGVNYXAiLCJfdGhpcyIsIm15UGxhY2VtYXJrIiwieW1hcHMiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYWRkIiwicmVtb3ZlIiwiTWFwIiwiZXZlbnRzIiwiZ2V0IiwiX2RlYm91bmNlMiIsIl9yb3V0ZXMyIiwicXVlcnlTZWxlY3RvciIsImdvb2dsZU1hcCIsInlhbmRleE1hcCIsImhpc3RvcnkiLCJ3ZWF0aGVyIiwibWFpbkh0bWwiLCJ3ZWF0aGVySHRtbCIsInJvdXRlcyIsInBvc2l0aW9uIiwiaGFzaCIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiY2l0eSIsImNoZWNrUmVzb3VyY2VzIiwiZGVjb2RlVVJJIiwiY29vcmQiLCJfZ29vZ2xlTWFwIiwiYXBwbHkiLCJfdG9Db25zdW1hYmxlQXJyYXkiLCJfd2VhdGhlciIsImdldEZvcmVjYXN0QnlMYXRMbmciLCJjb25jYXQiLCJjYXRjaCIsIl93ZWF0aGVyMiIsIl95YW5kZXhNYXAiLCJjbGVhclJlc291cmNlcyIsImhpZGRlbiIsInJlbW92ZUF0dHJpYnV0ZSIsIl9ldmVudEJ1czIiLCJfZ29vZ2xlU2VhcmNoMiIsIk51bWJlciIsImlzTmFOIiwiX3lhbmRleE1hcDMiLCJfbGlzdENvbXBvbmVudDIiLCJfd2VhdGhlckZvcmVjYXN0MiIsIl9zZWFyY2hDb21wb25lbnQyIiwiZnVuYyIsImRlbGF5IiwidGltZXJJRCIsInNlbGYiLCJwYXJhbXMiLCJhcmd1bWVudHMiLCJFdmVudEJ1cyIsImxpc3RlbmVycyIsImNiIiwic2xpY2UiLCJ0b1N0cmluZyIsImluZGV4T2YiLCJwdXNoIiwib2ZmIiwic3BsaWNlIiwib25jZSIsImZ1bmN0aW9uVG9PZmYiLCJsc1N0b3JhZ2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJzZXRJdGVtIiwicmVxdWVzdCIsInVybCIsInJlamVjdCIsInhociIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIm9ubG9hZCIsInN0YXR1cyIsInJlc3BvbnNlIiwic3RhdHVzVGV4dCIsIm9uZXJyb3IiLCJzZW5kIiwiUm91dGVyIiwicm91dGVQYXJhbXMiLCJjdXJyZW50Um91dGUiLCJwcmV2aW91c1JvdXRlIiwiY3VycmVudFBhcmFtcyIsInByZXZpb3VzUGFyYW1zIiwiaGFuZGxlciIsImZpbmROZXdSb3V0ZSIsImxhdW5jaEhhbmRsZXJzIiwibWF0Y2giLCJSZWdFeHAiLCJ0ZXN0Iiwib25MZWF2ZSIsIm9uQmVmb3JlRW50ZXIiLCJvbkVudGVyIiwiaWNvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2V0IiwiU2t5Y29ucyIsInRvVXBwZXJDYXNlIiwicmVwbGFjZSIsInNreWNvbnMiLCJwbGF5Iiwic2V0SWNvbnMiLCJ1c2VyTG9jYXRpb24iXSwibWFwcGluZ3MiOiJDQUFBLFNBQUFBLEVBQUFDLEVBQUFDLEVBQUFDLEdBQUEsU0FBQUMsRUFBQUMsRUFBQUMsR0FBQSxJQUFBSixFQUFBRyxHQUFBLENBQUEsSUFBQUosRUFBQUksR0FBQSxDQUFBLElBQUFFLEVBQUEsbUJBQUFDLFNBQUFBLFFBQUEsSUFBQUYsR0FBQUMsRUFBQSxPQUFBQSxFQUFBRixHQUFBLEdBQUEsR0FBQUksRUFBQSxPQUFBQSxFQUFBSixHQUFBLEdBQUEsSUFBQUssRUFBQSxJQUFBQyxNQUFBLHVCQUFBTixFQUFBLEtBQUEsTUFBQUssRUFBQUUsS0FBQSxtQkFBQUYsRUFBQSxJQUFBRyxFQUFBWCxFQUFBRyxJQUFBUyxZQUFBYixFQUFBSSxHQUFBLEdBQUFVLEtBQUFGLEVBQUFDLFFBQUEsU0FBQWQsR0FBQSxJQUFBRSxFQUFBRCxFQUFBSSxHQUFBLEdBQUFMLEdBQUEsT0FBQUksRUFBQUYsR0FBQUYsSUFBQWEsRUFBQUEsRUFBQUMsUUFBQWQsRUFBQUMsRUFBQUMsRUFBQUMsR0FBQSxPQUFBRCxFQUFBRyxHQUFBUyxRQUFBLElBQUEsSUFBQUwsRUFBQSxtQkFBQUQsU0FBQUEsUUFBQUgsRUFBQSxFQUFBQSxFQUFBRixFQUFBYSxPQUFBWCxJQUFBRCxFQUFBRCxFQUFBRSxJQUFBLE9BQUFELEVBQUEsRUFBQWEsR0FBQSxTQUFBVCxFQUFBVSxFQUFBSixpRUNBQSxNQUFBSyxFQUFBWCxFQUFBLDBEQUVBLElBQUlZLEVBQUosb0RBR0ksU0FBQUMsRUFBQUMsU0FBc0JDLHdHQUNsQkYsUUFBQUMsU0FBQUEsT0FDQUEsU0FBQUUsR0FBQSxjQUFnQyxTQUFBQyxLQUU1QkMsYUFBa0JELEVBQWxCRSxJQUEyQkYsRUFBM0JHLEtBQUFDLEtBRVEsU0FBQUMsS0FDSVIsU0FBQVMsUUFBQSxtQkFBQUQsRUFBQUwsSUFFSixTQUFBTyxPQUNRRixFQUFXRyxPQUFBLHNDQUFmLGFBQ0FILEtBQ0lSLFNBQUFTLFFBQUEsbUJBQUFELEVBQUFMLFlBSXBCUyxVQUFpQixTQUFBQyxvRkFBVUEsRUFBQSxRQUFBZixHQUFBUyxLQUNqQixTQUFBTyxVQUFVQSxFQUFBQyxRQUFBLEdBQUFDLFNBQVZDLGlCQUVWYixhQUFvQixTQUFBQyxFQUFBQyxtRkFBY0QsRUFBQSxJQUFBQyxFQUFBLHlDQUFBUixHQUFBUyxLQUN4QixTQUFBTyxVQUFVQSxFQUFBQyxRQUFBLEdBQUFHLG1CQUFBLEdBQVZDLHFYQ3pCbEJDLEVBQUFsQyxFQUFBLGdFQUVNbUMsRUFBQSxzQkFDRkMsRUFBQUMsRUFBQUMsRUFBQUMsRUFBQXpCLHNHQUNJcUIsUUFBQUUsY0FBcUJBLEdBQXJCLE9BQ0FELFlBQUFBLE9BQ0FJLGNBQ0FGLFlBQUFBLE9BQ0FDLFlBQUFBLE9BQ0F6QixTQUFBQSxPQUNBMkIsT0FDQSxjQUFJMUIsS0FBQXVCLGtCQUNBSSw0REFLSjNCLEtBQUEsY0FBSUEsS0FBQXVCLGtCQUNBeEIsU0FBQUUsR0FBQSxtQkFBcUNELEtBQUE0QixRQUFBQyxLQUFyQzdCLGlCQUVKOEIsUUFBaUI5QixLQUFqQnVCLGFBQUFqQixLQUNVLFNBQUF5QixLQUNGTixNQUFhTyxLQUFBQyxNQUFBRixTQUNiRyxpREFLUlYsWUFBQVcsVUFBQSxPQUNJQyxFQUFLQyxTQUFBQyxjQUFULFVBQ0ssSUFBTEMsS0FBZ0J2QyxLQUFoQnlCLE1BQTRCLEtBQ3BCZSxFQUFLSCxTQUFBQyxjQUFULE1BQ0l0RCxFQUFJcUQsU0FBQUMsY0FBUixPQUVBRyxLQUFTLGNBQUF6QyxLQUFBdUIsWUFBQSxXQUE4Q3ZCLEtBQUF5QixNQUFBYyxHQUE5Q25DLElBQUEsSUFBcUVKLEtBQUF5QixNQUFBYyxHQUFyRWxDLElBQUEsU0FBVGtDLElBQ0FKLFVBQWNJLEdBQU92QyxLQUFBcUIsWUFBQSwrREFBckIsTUFDQXFCLFlBQUExRCxLQUNBMkQsYUFBQUgsRUFBb0JKLEVBQXBCUSxpQkFHSnBCLFlBQUFrQixZQUFBTiw4Q0FHQXBDLEtBQUlBLEtBQUpxQixrQkFDSUcsWUFBQXFCLGlCQUFBLFFBQTJDLFNBQUFDLE1BQ25DQSxFQUFBQyxPQUFBQyxRQUFKLHFCQUE0QyxHQUN4Q0MscUJBQ0lWLEVBQU1PLEVBQUFDLE9BQUFHLGNBQVZDLFlBQ0FwRCxTQUFBUyxRQUFBLGlCQUF3QzRDLEVBQUEzQixNQUF4Q2MsV0FDT2EsRUFBQTNCLE1BQVBjLGFBQ0FjLFFBQWlCRCxFQUFqQjdCLFlBQW1DUyxLQUFBc0IsVUFBZUYsRUFBbEQzQixVQUNBUyw0Q0FNUkssRUFBS3JDLFFBQ1RxRCxJQUFJdkQsS0FBQXlCLE1BQUFjLFVBR0pkLE1BQUFjLEdBQWtCckMsTUFFbEIsY0FBSUYsS0FBQXVCLGtCQUNBeEIsU0FBQVMsUUFBQSxjQUFxQ1IsS0FBQXlCLE1BQXJDYyxJQUVBLElBQUF2QyxLQUFBc0IsZUFBNEJrQyxPQUFBQyxLQUFZekQsS0FBWnlCLE9BQUFoQyxPQUFpQ08sS0FBakVzQixzQkFDV3RCLEtBQUF5QixNQUFXK0IsT0FBQUMsS0FBWXpELEtBQVp5QixPQUFsQixTQUVKUyxtQkFDQW1CLFFBQWlCckQsS0FBakJ1QixZQUFtQ1MsS0FBQXNCLFVBQWV0RCxLQUFsRHlCLGVBcEVGLGFBeUVTTCw0V0MzRVRzQyxFQUFBLHNCQUNGbEMsRUFBQXpCLHNHQUNJMkQsUUFBQWxDLFlBQUFBLE9BQ0F6QixTQUFBQSxPQUNBMkIsc0RBSUExQixVQUFBa0MsY0FDQVYsWUFBQXFCLGlCQUFBLFdBQThDLFNBQUFjLEdBQ3RDQSxFQUFBWixPQUFBQyxRQUFKLFVBQ0ksSUFBSVcsRUFBQUMsV0FDQUMsa0JBSVpyQyxZQUFBcUIsaUJBQUEsUUFBMkMsU0FBQWMsR0FDbkNBLEVBQUFaLE9BQUFDLFFBQUosYUFDSWEsZ0RBTVIsS0FBSTdELEtBQUE4RCxNQUFBQyxhQUdKaEUsU0FBQVMsUUFBQSxjQUFxQ1IsS0FBQThELE1BQXJDQyxZQUNBRCxNQUFBQyxNQUFBLDBDQUdBdkMsWUFBQVcsVUFBQSxRQUNBMkIsTUFBYXpCLFNBQUFDLGNBQWIsY0FDQXdCLE1BQUFFLFVBQUEsZ0NBQ0FGLE1BQUFHLFlBQUEsWUFDQXpDLFlBQUFrQixZQUE2QjFDLEtBQTdCOEQsV0FDSUksRUFBTzdCLFNBQUFDLGNBQVgsVUFDQTBCLFVBQUEsc0JBQ0lHLEVBQU05QixTQUFBQyxjQUFWLFlBQ0EwQixVQUFBLCtDQUNBSSxLQUFBLGFBQ0lDLEVBQWFoQyxTQUFBQyxjQUFqQixVQUNBMEIsVUFBQSwrQkFDQXRCLFlBQUEyQixLQUNBM0IsWUFBQXlCLFFBQ0EzQyxZQUFBa0IsWUFBQXdCLFNBN0NGLGFBb0RTUixxVkNwRGZ6RSxFQUFBLHlCQUNBQSxFQUFBLHdFQUNBLElBQUlzRCxFQUFKLG1DQUVNK0IsRUFBQSxzQkFDRkMsRUFBQXhFLHNHQUNJdUUsUUFBQUUsUUFBQUQsT0FDQXhFLFNBQUFBLHdEQUVnQkssRUFBS0MsRUFBS0UsU0FDMUJQLFVBQUFPLFNBQUFBLHdGQUNBZ0MsRUFBQSxJQUFBbkMsRUFBQSxJQUFBQyxFQUFBLHFCQUFBQyxLQUNVLFNBQUFtRSxVQUFTQSxFQUFUQyxTQURWcEUsS0FFVSxTQUFBeUIsS0FDRkcsT0FBWUgsRUFBQTRDLE1BQVo5RCxvREFJUVQsRUFBS0MsRUFBS0UsU0FDMUJQLFVBQUFPLFNBQUFBLHdGQUNBZ0MsRUFBQSxJQUFBbkMsRUFBQSxJQUFBQyxFQUFBLHFCQUFBQyxLQUNVLFNBQUF5QixLQUNGRyxPQUFZSCxFQUFBNEMsTUFBWjlELHVDQUdMK0QsUUFDSEosUUFBQXJDLFVBQUEsT0FDSTBDLEVBQVN4QyxTQUFBQyxjQUFiLFVBQ0FILFVBQUEsVUFBNkJuQyxLQUE3Qk8sY0FDQWlFLFFBQUE5QixZQUFBbUMsT0FDSUMsRUFBUXpDLFNBQUFDLGNBQVosV0FDQTBCLFVBQUEseUJBQ0llLEVBQUsxQyxTQUFBQyxjQUFULE1BQ0kwQyxFQUFXM0MsU0FBQUMsY0FBZixRQUNBSCxVQUFBLFdBQ0k4QyxFQUFPLElBQVhDLE9BQ0F4QyxZQUFBc0MsT0FDSyxJQUFJRyxFQUFULEVBQW9CQSxFQUFwQixFQUFBQSxJQUF3QyxLQUNoQ0MsRUFBSy9DLFNBQUFDLGNBQVQsUUFDQUgsVUFBa0I4QyxFQUFsQkksVUFBQSxLQUFvQ0osRUFBQUssV0FBcEMsS0FDQTVDLFlBQUEwQyxLQUNBRyxRQUFhTixFQUFBSSxVQUFiLEtBRUozQyxZQUFBcUMsS0FFSzFDLFNBQUFDLGNBQUwsVUFDSWtELEVBQVduRCxTQUFBQyxjQUFmLFFBQ0FJLFlBQUE4QyxPQUNLLElBQUlDLEVBQVQsRUFBb0JBLEVBQXBCLEVBQUFBLElBQXdDLEtBQ2hDQyxFQUFLckQsU0FBQUMsY0FBVCxRQUNBSCxVQUFBLGtCQUFpQ3lDLEVBQUFhLEdBQWpDRSxLQUNBLHVDQUFBakQsWUFBQWdELEtBRUpoRCxZQUFBcUMsS0FFQXJDLFlBQWtCMUMsS0FBQTRGLFVBQUFoQixFQUFBLGtCQUFsQixzQkFDQWxDLFlBQWtCMUMsS0FBQTRGLFVBQUFoQixFQUFBLG9CQUFsQixxQkFDQWxDLFlBQWtCMUMsS0FBQTRGLFVBQUFoQixFQUFBLGFBQWxCLG1CQUVBSixRQUFBOUIsWUFBQW9DLFFBRUhlLDZDQUVTQyxFQUFRQyxFQUFXQyxPQUNyQmpCLEVBQUsxQyxTQUFBQyxjQUFULE1BQ0lrRCxFQUFXbkQsU0FBQUMsY0FBZixRQUNBSCxVQUFBNEQsSUFDQXJELFlBQUE4QyxPQUNLLElBQUlMLEVBQVQsRUFBb0JBLEVBQXBCLEVBQUFBLElBQXdDLEtBQ2hDTyxFQUFLckQsU0FBQUMsY0FBVCxRQUNBSCxVQUFlMkQsRUFBQVgsR0FBZmEsS0FDQXRELFlBQUFnRCxVQUVKWCxRQXJFRixhQXlFU1QsbUlDN0VmLFFBQUFyRixFQUFBLDBCQUNBQSxFQUFBLDBFQUVBLFNBQUFnSCxFQUFBbkQsT0FDUW9ELEVBQVNDLEVBQWJDLGlCQUNBckcsU0FBQVMsUUFBQSxZQUFtQzBGLEVBQW5DLEdBQThDQSxFQUE5QyxJQUtKLElBQUFDLEVBQ0lFLEtBRUosU0FBQUMsRUFBQXZHLEVBQUFLLEVBQUFDLEVBQUFrQixRQUNJZ0YsU0FBQW5HLE9BQ0FvRyxTQUFBbkcsT0FDQU4sU0FBQUEsT0FDQXdCLFlBQUFBLE9BQ0FHLE9BSUo0RSxFQUFBRyxVQUFBQyxPQUE2QixTQUFBdEcsRUFBQUMsS0FDekJzRyxRQUFZdkcsR0FBWkMsSUFBNEJ1RyxTQUE1QixPQUdKTixFQUFBRyxVQUFBL0UsS0FBMkIsaUJBQ3ZCMUIsV0FBQTZHLE1BQVksYUFDUkMsV0FBZ0JDLEVBQURSLFNBQWdCUSxFQUEvQlAscUJBRUExRSxRQUFpQmlGLEVBQWpCeEYsYUFBQWpCLEtBQXdDLFNBQUFPLE9BQ2hDWSxFQUFRTyxLQUFBQyxNQUFBcEIsV0FDUCxJQUFMMEIsS0FBQWQsRUFBdUIsS0FDZnVGLEVBQUEsSUFBa0JDLE1BQUpDLFdBQXFCekYsRUFBQWMsR0FBRCxJQUFvQmQsRUFBQWMsR0FBeEMsZ0JBQWdFLG9DQUFsRixXQUljZCxFQUFBYyxHQUFkLElBQUEsSUFBb0NkLEVBQUFjLEdBQXBDLEtBQUF5RSxJQUNBRyxXQUFBQyxJQUFBSixRQUtSakgsU0FBQUUsR0FBQSxjQUFnQyxTQUFBaUcsT0FDeEJjLEVBQUEsSUFBa0JDLE1BQUpDLFdBQXFCaEIsRUFBRCxJQUFnQkEsRUFBcEMsZ0JBQXdELG9DQUExRSxXQUljQSxFQUFkLElBQUEsSUFBK0JBLEVBQS9CLEtBQUFjLElBQ0FHLFdBQUFDLElBQUFKLE9BR0pqSCxTQUFBRSxHQUFBLGlCQUFtQyxTQUFBaUcsS0FDL0JpQixXQUFBRSxPQUF3QmhCLEVBQWNILEVBQWQsSUFBQSxJQUErQkEsRUFBdkQsYUFDT0csRUFBY0gsRUFBZCxJQUFBLElBQStCQSxFQUF0QyxVQU1aSSxFQUFBRyxVQUFBSyxVQUFnQyxTQUFBWixTQUU1QmxHLFlBQVlpSCxNQUFKSyxJQUFBLGVBQ0twQixFQUFELEdBQVlBLEVBREssU0FBQSxhQUFyQix1Q0FBUixLQVFBcUIsT0FBQUgsSUFBQSxRQUEwQixTQUFBM0ksT0FFbEJ5SCxFQUFTekgsRUFBQStJLElBQWIsVUFPSXRILE9BQ0tnRyxFQURDLE9BRURBLEVBRlQsTUFJQW5HLFNBQUFTLFFBQUEsY0FBQU4sT0FHSnFILE9BQUFILElBQUEsYUFBOEIsRUFBQUssRUFBQTVCLFNBQUFJLEVBQUEsS0FBQXBFLEtBQTlCN0IsUUFHSnNHLEVBQUFHLFVBQUFMLFVBQWdDLGtCQUNyQkQsRUFBUEMsdUJBSVdFLG9GQzlGZixRQUFBckgsRUFBQSxnRUFJYSxNQUhiQSxFQUFBLG1CQUdhNEcsU0FBQTZCLEVBQWI3QiwrSENKQSxRQUFBNUcsRUFBQSxtQ0FDQUEsRUFBQSxrQ0FDQUEsRUFBQSwrQkFDQUEsRUFBQSxxQ0FDQUEsRUFBQSx5QkFFQUEsRUFBQSw2QkFDQUEsRUFBQSx3QkFDQUEsRUFBQSw0TUFFWW9ELFNBQUFzRixjQUFaLFlBQ0E5RSxpQkFBQSxRQUFnQyxTQUFBQyxhQUM1QnNCLEtBQWUvQixTQUFBc0YsY0FBQSx5Q0FBZjVELFFBR0osSUFBSWhFLE9BQUEsRUFDQTZILE9BQUEsRUFDQUMsT0FBQSxFQUVBQyxPQUFBLEVBQ0FDLE9BQUEsRUFHQUMsRUFBVzNGLFNBQUFzRixjQUFmLFFBQ0lNLEVBQWM1RixTQUFBc0YsY0FBbEIsWUFFSU8sVUFBVSxXQUVHLHFCQUNMNUgsS0FDVSxTQUFBNkgsVUFDRm5ILFNBQUFvSCxLQUEwQkQsRUFBMUJFLFNBQUEsSUFBK0NGLEVBQS9DRyxxQkFJaEIsb0JBRWEsU0FBQUMsR0FDTEMsT0FRSTVHLFFBQWdCNkcsVUFBaEJGLE1BQ0E1SCxVQUFBNEgsR0FBQWpJLEtBQ1UsU0FBQU8sS0FDRjZGLE9BQWlCN0YsRUFBakIsSUFBOEJBLEVBQTlCLFdBVlIwSCxLQUNBM0csUUFBZ0I2RyxVQUFoQkYsTUFDQTVILFVBQUE0SCxHQUFBakksS0FBK0IsU0FBQU8sVUFFM0JHLFNBQUFvSCxLQUEwQnZILEVBQTFCLElBQUEsSUFBeUNBLEVBQXpDLGdCQVliLGdEQUdVLFNBQUE2SCxPQUVMQyxFQUFBSCxzQkFDSUUsVUFFSnZJLGFBQUF5SSxNQUFBRCxFQUFBRSxFQUFBSCxJQUFBcEksS0FDSSxTQUFBQyxPQUFBdUksU0FBWUEsRUFBQWYsR0FBQWdCLG9CQUFBSCxNQUFBRSxFQUFBRCxFQUFBSCxHQUFBTSxRQUFaekksT0FESjBJLE1BRVEsU0FBQXhJLE9BQUF5SSxTQUFPQSxFQUFBbkIsR0FBQWdCLG9CQUFBSCxNQUFBTSxFQUFBTCxFQUFBSCxHQUFBTSxRQUFQLDhCQUdiLDREQUVnQixTQUFBTixPQUFBUyxTQUFXWCxLQUFtQlcsRUFBQXRCLEdBQUFuQixPQUFBa0MsTUFBQU8sRUFBQU4sRUFBbkJILElBQWdEaEgsRUFBQWtILFdBQUFyRixFQUFBc0YsRUFBM0RILGFBR25CLGlCQUVhLFdBRUxVLE1BQUFDLE9BQUEsZ0JBQ0ExQixjQUFBLFdBQUEzRCxVQUFBLFlBQ0EyRCxjQUFBLG9CQUFBekUsY0FBQWMsVUFBQSxXQUNBN0IsVUFBQSwwQ0FFTCxnQkFFVSxXQUVMaUgsTUFBQUMsT0FBQSxnQkFDQTFCLGNBQUEsV0FBQTNELFVBQUEsWUFDQTJELGNBQUEsbUJBQUF6RSxjQUFBYyxVQUFBLFdBQ0E3QixVQUFBLG9EQU1aLFNBQUFxRyxhQUNXVixHQUFBRixHQUFBQyxHQUFBRSxHQUdYLFNBQUFxQixNQUVJLE9BQ0EsT0FDQSxLQUNBLE9BQ0EsT0FDQSxLQUNBLEtBSUosU0FBQTFILEVBQUF0QixFQUFBQyxLQUNJaUosZ0JBQUEsWUFDQW5ILFVBQUEsWUFDQXdGLGNBQUEsV0FBQTNELFVBQUEsWUFDQTJELGNBQUEsaUJBQUF6RSxjQUFBYyxVQUFBLFdBQ1csSUFBQXVGLEVBQVgxRCxVQUNZLElBQUEyRCxFQUFBM0QsUUFBWjlGLEdBQ0kwSixPQUFBQyxPQUFKdEosS0FDSU8sVUFBQVAsR0FBQUUsS0FDVSxTQUFBTyxLQUNVLElBQUE4SSxFQUFBOUQsUUFBQTlGLEVBQXdCYyxFQUF4QixJQUFxQ0EsRUFBckMsSUFBWixpQkFHSSxJQUFBOEksRUFBQTlELFFBQUE5RixFQUFBSyxFQUFBQyxFQUFaLGFBSVEsSUFBQXVKLEVBQUEvRCxTQUFBLEVBQUEsRUFBQSxZQUF3Q3hELFNBQUFzRixjQUF4QyxvQkFBWjVILEtBQ1UsSUFBQTZKLEVBQUEvRCxTQUFBLEVBQUEsRUFBQSxVQUF1Q3hELFNBQUFzRixjQUFqRCxxQkFDVSxJQUFBa0MsRUFBQWhFLFFBQW9CeEQsU0FBQXNGLGNBQXBCLHNCQUFWNUgsR0FDWSxJQUFBK0osRUFBQWpFLFFBQWN4RCxTQUFBc0YsY0FBZCxnQkFBWjVILEtBR0FFLEdBQUEsY0FBMkIsU0FBQXNJLFVBQ3ZCdkgsU0FBQW9ILEtBQUEsUUFBQUcsTUFHSnRJLEdBQUEsWUFBeUIsU0FBQUcsRUFBQUMsVUFFckJXLFNBQUFvSCxLQUFBaEksRUFBQSxJQUFBQyxjQUlPNkgsK1RDaEpmLFNBQUE2QixFQUFBQyxPQUNJQyxTQUNPLGVBQ0NDLEVBQUpsSyxLQUNJbUssRUFBSkMsdUJBQ0FILGdCQUNxQixrQkFDVkYsRUFBQW5CLE1BQUFzQixFQUFQQyxJQURKSCwyRkNIUixTQUFBSyxTQUNJQyxhQU9KRCxFQUFBNUQsVUFBQWpHLFFBQTZCLFNBQUFtRCxPQUVwQixJQUFJekUsRUFBVCxFQUFnQkEsR0FBS2MsS0FBQXNLLFVBQUEzRyxRQUFyQmxFLE9BQUFQLElBQStELEtBQ3ZEcUwsRUFBS3ZLLEtBQUFzSyxVQUFBM0csR0FBVHpFLE1BQ0EsbUJBQUlxTCxFQUEwQixLQUN0QkosS0FBU0ssTUFBQWhMLEtBQUE0SyxVQUFiLEtBQ0F4QixNQUFBLEtBQUF1QixJQUNBLElBQUlJLEVBQUFFLFdBQUFDLFFBQUEsYUFFSHhMLE9BVWJtTCxFQUFBNUQsVUFBQXhHLEdBQXdCLFNBQUEwRCxFQUFBNEcsUUFFcEJELFVBQUEzRyxHQUF5QjNELEtBQUFzSyxVQUFBM0csWUFDekIyRyxVQUFBM0csR0FBQWdILEtBQUFKLElBUUpGLEVBQUE1RCxVQUFBbUUsSUFBeUIsU0FBQWpILEVBQUE0RyxXQUVyQmhILEdBQUl2RCxLQUFBc0ssVUFBQTNHLFFBR0F3RSxFQUFXbkksS0FBQXNLLFVBQUEzRyxHQUFBK0csUUFBZkgsUUFDQUQsVUFBQTNHLEdBQUFrSCxPQUFBMUMsRUFBQSxLQVFKa0MsRUFBQTVELFVBQUFxRSxLQUEwQixTQUFBbkgsRUFBQTRHLE9BQ2xCTCxFQUFKbEssT0FPQUMsR0FBQTBELFdBTEFvSCxNQUNJbkMsTUFBQSxLQUFBd0IsYUFDQVEsSUFBQWpILEVBQUFvSCxnQkFNT1YseUZDbEVmLElBQUlXLFdBQ1MsU0FBQXpJLFVBQVMwSSxRQUFBQyxRQUFnQkMsT0FBQUMsYUFBQUMsUUFBekI5SSxhQUNBLFNBQUFBLEVBQUF3QixVQUFnQmtILFFBQUFDLFFBQWdCQyxPQUFBQyxhQUFBRSxRQUFBL0ksRUFBaEN3QixnQkFHRWlILHlGQ0xmLFNBQUFPLEVBQUFDLFNBQ1ksUUFBQUQsRUFBQW5ILE1BVVpvSCxFQVZZQSxNQVdEUCxRQUFZLFNBQUFDLEVBQUFPLE9BQ1hDLEVBQU0sSUFBVkMsaUJBQ0FDLEtBQUEsTUFBQUosS0FDQUssT0FBYSxXQUNMN0wsS0FBQThMLFFBQUEsS0FBc0I5TCxLQUFBOEwsT0FBMUIsTUFDWTlKLEtBQUFDLE1BQVd5SixFQUFuQksscUJBR1kvTCxLQURMOEwsa0JBRVNKLEVBRmhCTSxnQkFNUkMsUUFBYyxxQkFFRWpNLEtBREw4TCxrQkFFU0osRUFGaEJNLGdCQUtKRSxnQkE5QkpWLEdBTU9sTCxLQUNHLFNBQUFtRSxVQUFTQSxFQUFUQyxTQUZkLElBS0E4RyxFQVBBRCxFQUFBbkgsS0FBQSxnQkErQmVtSCx5RkMvQmYsU0FBQVksRUFBQUMsU0FDSXBNLFVBQUFrSSxPQUFja0UsV0FDZEMsa0JBQ0FDLG1CQUNBQyxtQkFDQUMsc0JBQ0EzSixpQkFBQSxhQUFzQyxTQUFBYyxLQUNsQzhJLFFBQWF0QixPQUFBbkssU0FBYm9ILGFBRUpxRSxRQUFhdEIsT0FBQW5LLFNBQWJvSCxNQUdKK0QsRUFBQTFGLG1CQUNhLFNBQUEyQixRQUNMa0UsY0FBcUJ0TSxLQUFyQnFNLGtCQUNBRyxlQUFzQnhNLEtBQXRCdU0sbUJBQ0FGLGFBQW9Cck0sS0FBQTBNLGFBQXBCdEUsUUFDQXVFLCtCQUVVLFNBQUF2RSxLQUNIQSxFQUFBb0MsTUFBUCxPQUVLLElBQUl0TCxFQUFULEVBQWdCQSxFQUFJYyxLQUFBa0ksT0FBcEJ6SSxPQUFBUCxJQUE2QyxLQUNyQ3NGLEVBQVV4RSxLQUFBa0ksT0FBZGhKLE1BQ0ksaUJBQU9zRixFQUFQb0ksT0FBcUNwSSxFQUFBb0ksUUFBekN4RSxjQUNJbUUsY0FBQSxHQUNBL0gsS0FFQSxtQkFBT0EsRUFBUG9JLE9BQXVDcEksRUFBQW9JLE1BQTNDeEUsZUFDSW1FLGNBQUEsR0FDQS9ILEtBRUNBLEVBQUFvSSxpQkFBREMsUUFBcUNySSxFQUFBb0ksTUFBQUUsS0FBekMxRSxlQUNJbUUsY0FBcUJuRSxFQUFBd0UsTUFBV3BJLEVBQVhvSSxnQkFDckJMLGNBQUExQixPQUFBLEVBQUEsR0FDQXJHLElBdkJHbUksZUFBQSxpQkE0QlgzTSxhQUFBa0wsVUFBQTVLLEtBQ1UsYUFBUWdNLGVBQXNCbEosRUFBQWtKLGNBQXRCUyxTQUFvRDNKLEVBQUFrSixjQUFBUyxRQUEyQjNKLEVBQS9Fb0osa0JBRGxCbE0sS0FFVSxhQUFRK0wsY0FBcUJqSixFQUFBaUosYUFBckJXLGVBQXdENUosRUFBQWlKLGFBQUFXLGNBQWdDNUosRUFBeEZtSixpQkFGbEJqTSxLQUdVLGFBQVErTCxjQUFxQmpKLEVBQUFpSixhQUFyQlksU0FBa0Q3SixFQUFBaUosYUFBQVksUUFBMEI3SixFQUE1RW1KLDZCQUlYSixtR0N0Q0EsZUFFTixJQUREZSxFQUFRN0ssU0FBQThLLGlCQUFaLFVBQ1NqTyxFQUFULEVBQWdCQSxFQUFJZ08sRUFBcEJ6TixPQUFBUCxNQUNJa08sSUFBWUYsRUFBWmhPLEdBQXNCbU8sUUFBUUgsRUFBQWhPLEdBQUE4RSxVQUFBc0osY0FBQUMsUUFBQSxLQUE5QixRQWhCUixJQUFJQyxFQUFVLElBQWRILFNBRUEsZUFHUyxJQURESCxFQUFRN0ssU0FBQThLLGlCQUFaLFVBQ1NqTyxFQUFULEVBQWdCQSxFQUFJZ08sRUFBcEJ6TixPQUFBUCxNQUNJa0ksSUFBWThGLEVBQVpoTyxHQUFzQm1PLFFBQVFILEVBQUFoTyxHQUFBOEUsVUFBQXNKLGNBQUFDLFFBQUEsS0FBOUIsU0FHSkUsT0FFSkMsMEZDWEEsTUFBQTlOLEVBQUFYLEVBQUEsYUFFQSxJQUFJME8sR0FBQSxzQ0FBQTlILFNBQWUscUNBQUF2RixLQUFrRCxTQUFBTyxVQUFRQSxFQUFSc0gscUJBR3REd0YiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJpbXBvcnQgcmVxdWVzdCBmcm9tICcuLi91dGlscy9yZXF1ZXN0JztcblxubGV0IEdPT0dMRV9BUElfS0VZID0gJ0FJemFTeUIyRC1DbWVrOGlmUGQwYkhPRnpLc2RGVG9mblhCV29JRSc7XG5cbmNsYXNzIEdvb2dsZU1hcCB7XG4gICAgY29uc3RydWN0b3IoZXZlbnRCdXMpIHtcbiAgICAgICAgdGhpcy5ldmVudEJ1cyA9IGV2ZW50QnVzO1xuICAgICAgICB0aGlzLmV2ZW50QnVzLm9uKCdtYXA6Y2xpY2tlZCcsIChvYmopID0+IHtcblxuICAgICAgICAgICAgdGhpcy5nZXRQbGFjZU5hbWUob2JqLmxhdCwgb2JqLmxuZylcbiAgICAgICAgICAgICAgICAudGhlbihcbiAgICAgICAgICAgICAgICAgICAgY2l0eU5hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKCdnb29nbGU6Y2l0eUZvdW5kJywgY2l0eU5hbWUsIG9iailcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZXJyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjaXR5TmFtZSA9IHByb21wdCgn0J3QtdC40LfQstC10YHRgtC90L7QtSDQvNC10YHRgtC+LiDQktCy0LXQtNC40YLQtSDQvdCw0LfQstCw0L3QuNC1JywgJ0hvbGx5V29vZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNpdHlOYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKCdnb29nbGU6Y2l0eUZvdW5kJywgY2l0eU5hbWUsIG9iailcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmdldExhdExuZyA9IChhZGRyKSA9PiByZXF1ZXN0KGBodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy9hcGkvZ2VvY29kZS9qc29uP2FkZHJlc3M9JHthZGRyfSZrZXk9JHtHT09HTEVfQVBJX0tFWX1gKVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IGRhdGEucmVzdWx0c1snMCddLmdlb21ldHJ5LmxvY2F0aW9uKTtcblxuICAgICAgICB0aGlzLmdldFBsYWNlTmFtZSA9IChsYXQsIGxuZykgPT4gcmVxdWVzdChgaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2dlb2NvZGUvanNvbj9sYXRsbmc9JHtsYXR9LCR7bG5nfSZyZXN1bHRfdHlwZT1sb2NhbGl0eSZsYW5ndWFnZT1ydSZrZXk9JHtHT09HTEVfQVBJX0tFWX1gKVxuICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IGRhdGEucmVzdWx0c1snMCddLmFkZHJlc3NfY29tcG9uZW50c1swXS5zaG9ydF9uYW1lKTtcbiAgICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBHb29nbGVNYXA7IiwiaW1wb3J0IGlTdG9yYWdlIGZyb20gXCIuLi91dGlscy9sc1N0b3JhZ2VcIjtcblxuY2xhc3MgTGlzdENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoYWxsb3dSZW1vdmUsIG1heEl0ZW1BbW91bnQsIHN0b3JhZ2VOYW1lLCBodG1sRWxlbWVudCwgZXZlbnRCdXMpIHtcbiAgICAgICAgdGhpcy5tYXhJdGVtQW1vdW50ID0gbWF4SXRlbUFtb3VudCB8fCAwO1xuICAgICAgICB0aGlzLmFsbG93UmVtb3ZlID0gYWxsb3dSZW1vdmU7XG4gICAgICAgIHRoaXMuaXRlbXMgPSB7fTtcbiAgICAgICAgdGhpcy5zdG9yYWdlTmFtZSA9IHN0b3JhZ2VOYW1lO1xuICAgICAgICB0aGlzLmh0bWxFbGVtZW50ID0gaHRtbEVsZW1lbnQ7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMgPSBldmVudEJ1cztcbiAgICAgICAgdGhpcy5pbml0KCk7XG4gICAgICAgIGlmICh0aGlzLnN0b3JhZ2VOYW1lID09PSAnRmF2b3JpdGVzJykge1xuICAgICAgICAgICAgdGhpcy5hZGRSZW1vdmFsKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgaW5pdCgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RvcmFnZU5hbWUgPT09ICdGYXZvcml0ZXMnKSB7XG4gICAgICAgICAgICB0aGlzLmV2ZW50QnVzLm9uKCdnb29nbGU6Y2l0eUZvdW5kJywgdGhpcy5hZGRJdGVtLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgICAgIGlTdG9yYWdlLmdldERhdGEodGhpcy5zdG9yYWdlTmFtZSlcbiAgICAgICAgICAgIC50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pdGVtcyA9IEpTT04ucGFyc2UocmVzdWx0KSB8fCB7fTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICAgICAgfSlcblxuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHRoaXMuaHRtbEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIGxldCB1bCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLml0ZW1zKSB7XG4gICAgICAgICAgICBsZXQgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xuICAgICAgICAgICAgbGV0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG5cbiAgICAgICAgICAgIGEuaHJlZiA9IHRoaXMuc3RvcmFnZU5hbWUgPT09ICdGYXZvcml0ZXMnID8gYCNjZW50ZXI9JHt0aGlzLml0ZW1zW2tleV0ubGF0fSwke3RoaXMuaXRlbXNba2V5XS5sbmd9YCA6IGAjY2l0eT0ke2tleX1gO1xuICAgICAgICAgICAgYS5pbm5lckhUTUwgPSBrZXkgKyAodGhpcy5hbGxvd1JlbW92ZSA/ICc8c3BhbiBjbGFzcz1cImdseXBoaWNvbiBnbHlwaGljb24tcmVtb3ZlIGNyb3NzLWFsaWduLXJpZ2h0XCIvPicgOiAnJyk7XG4gICAgICAgICAgICBsaS5hcHBlbmRDaGlsZChhKTtcbiAgICAgICAgICAgIHVsLmluc2VydEJlZm9yZShsaSwgdWwuZmlyc3RDaGlsZCk7XG5cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5odG1sRWxlbWVudC5hcHBlbmRDaGlsZCh1bCk7XG4gICAgfTtcbiAgICBhZGRSZW1vdmFsKCkge1xuICAgICAgICBpZiAodGhpcy5hbGxvd1JlbW92ZSkge1xuICAgICAgICAgICAgdGhpcy5odG1sRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldikgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldi50YXJnZXQubWF0Y2hlcygnLmdseXBoaWNvbi1yZW1vdmUnKSkge1xuICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gZXYudGFyZ2V0LnBhcmVudEVsZW1lbnQuaW5uZXJUZXh0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmV2ZW50QnVzLnRyaWdnZXIoJ2xpc3Q6cmVtb3ZlRmF2JywgdGhpcy5pdGVtc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuaXRlbXNba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgaVN0b3JhZ2Uuc2V0RGF0YSh0aGlzLnN0b3JhZ2VOYW1lLCBKU09OLnN0cmluZ2lmeSh0aGlzLml0ZW1zKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBhZGRJdGVtKGtleSwgb2JqKSB7XG4gICAgICAgIGlmICh0aGlzLml0ZW1zW2tleV0gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXRlbXNba2V5XSA9IG9iaiB8fCB7fTtcblxuICAgICAgICBpZiAodGhpcy5zdG9yYWdlTmFtZSA9PT0gJ0Zhdm9yaXRlcycpIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRCdXMudHJpZ2dlcignbGlzdDphZGRGYXYnLCB0aGlzLml0ZW1zW2tleV0pO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm1heEl0ZW1BbW91bnQgIT09IDAgJiYgT2JqZWN0LmtleXModGhpcy5pdGVtcykubGVuZ3RoID4gdGhpcy5tYXhJdGVtQW1vdW50KSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5pdGVtc1tPYmplY3Qua2V5cyh0aGlzLml0ZW1zKVswXV07XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgaVN0b3JhZ2Uuc2V0RGF0YSh0aGlzLnN0b3JhZ2VOYW1lLCBKU09OLnN0cmluZ2lmeSh0aGlzLml0ZW1zKSk7XG4gICAgfTtcblxufVxuXG5leHBvcnQgZGVmYXVsdCBMaXN0Q29tcG9uZW50OyIsImNsYXNzIFNlYXJjaENvbXBvbmVudCB7XG4gICAgY29uc3RydWN0b3IoaHRtbEVsZW1lbnQsIGV2ZW50QnVzKSB7XG4gICAgICAgIHRoaXMuaHRtbEVsZW1lbnQgPSBodG1sRWxlbWVudDtcbiAgICAgICAgdGhpcy5ldmVudEJ1cyA9IGV2ZW50QnVzO1xuICAgICAgICB0aGlzLmluaXQoKTtcbiAgICB9O1xuXG4gICAgaW5pdCgpIHtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgdGhpcy5odG1sRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5tYXRjaGVzKCdpbnB1dCcpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmtleUNvZGUgPT0gMTMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nb1RvQ2l0eSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuaHRtbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQubWF0Y2hlcygnYnV0dG9uJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdvVG9DaXR5KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgfTtcbiAgICBnb1RvQ2l0eSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaW5wdXQudmFsdWUgPT09ICcnKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKCdzZWFyY2g6Y2l0eScsIHRoaXMuaW5wdXQudmFsdWUpO1xuICAgICAgICB0aGlzLmlucHV0LnZhbHVlID0gJyc7XG4gICAgfTtcbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHRoaXMuaHRtbEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgIHRoaXMuaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgICAgICB0aGlzLmlucHV0LmNsYXNzTmFtZSA9IFwiZm9ybS1jb250cm9sIGlucHV0X19jaXR5XCI7XG4gICAgICAgIHRoaXMuaW5wdXQucGxhY2Vob2xkZXIgPSAnY2l0eSc7XG4gICAgICAgIHRoaXMuaHRtbEVsZW1lbnQuYXBwZW5kQ2hpbGQodGhpcy5pbnB1dCk7XG4gICAgICAgIHZhciBzcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBzcGFuLmNsYXNzTmFtZSA9ICdpbnB1dC1ncm91cC1idG4nO1xuICAgICAgICB2YXIgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG4gICAgICAgIGJ0bi5jbGFzc05hbWUgPSAnYnRuIGJ0bi1kZWZhdWx0IHNlYXJjaCBidXR0b25fX3NlYXJjaF9jaXR5JztcbiAgICAgICAgYnRuLnR5cGUgPSAnYnV0dG9uJztcbiAgICAgICAgdmFyIHNwYW5TZWFyY2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIHNwYW5TZWFyY2guY2xhc3NOYW1lID0gJ2dseXBoaWNvbiBnbHlwaGljb24tc2VhcmNoJztcbiAgICAgICAgYnRuLmFwcGVuZENoaWxkKHNwYW5TZWFyY2gpO1xuICAgICAgICBzcGFuLmFwcGVuZENoaWxkKGJ0bik7XG4gICAgICAgIHRoaXMuaHRtbEVsZW1lbnQuYXBwZW5kQ2hpbGQoc3Bhbik7XG4gICAgfVxuXG59XG5cblxuXG5leHBvcnQgZGVmYXVsdCBTZWFyY2hDb21wb25lbnQ7IiwiaW1wb3J0IHVwZGF0ZUljb25zIGZyb20gJy4uL3V0aWxzL3NreWNvbnMnO1xuaW1wb3J0IHJlcXVlc3QgZnJvbSAnLi4vdXRpbHMvcmVxdWVzdCc7XG52YXIga2V5ID0gJzUwMzFlMDc1OTQ2NzM5YTc2ZjBlMzc1OTgwODZkMGEzJztcblxuY2xhc3MgV2VhdGhlckZvcmVjYXN0IHtcbiAgICBjb25zdHJ1Y3RvcihfZWxlbWVudCwgZXZlbnRCdXMpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gX2VsZW1lbnQ7XG4gICAgICAgIHRoaXMuZXZlbnRCdXMgPSBldmVudEJ1cztcbiAgICB9O1xuICAgIGdldEZvcmVjYXN0QnlMYXRMbmcobGF0LCBsbmcsIGNpdHlOYW1lKSB7XG4gICAgICAgIHRoaXMuY2l0eU5hbWUgPSBjaXR5TmFtZTtcbiAgICAgICAgcmVxdWVzdChgaHR0cHM6Ly9jb3JzLWFueXdoZXJlLmhlcm9rdWFwcC5jb20vaHR0cHM6Ly9hcGkuZGFya3NreS5uZXQvZm9yZWNhc3QvJHtrZXl9LyR7bGF0fSwke2xuZ30/bGFuZz1ydSZ1bml0cz1zaWApXG4gICAgICAgICAgICAudGhlbigocmVxKSA9PiByZXEuanNvbigpKVxuICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcihyZXN1bHQuZGFpbHkuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRGb3JlY2FzdEJ5TGF0TG5nKGxhdCwgbG5nLCBjaXR5TmFtZSkge1xuICAgICAgICB0aGlzLmNpdHlOYW1lID0gY2l0eU5hbWU7XG4gICAgICAgIHJlcXVlc3QoYGh0dHBzOi8vY29ycy1hbnl3aGVyZS5oZXJva3VhcHAuY29tL2h0dHBzOi8vYXBpLmRhcmtza3kubmV0L2ZvcmVjYXN0LyR7a2V5fS8ke2xhdH0sJHtsbmd9P2xhbmc9cnUmdW5pdHM9c2lgKVxuICAgICAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcihyZXN1bHQuZGFpbHkuZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgcmVuZGVyKGRhaWx5Rm9yZWNhc3QpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LmlubmVySFRNTCA9ICcnO1xuICAgICAgICB2YXIgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICBoZWFkZXIuaW5uZXJIVE1MID0gYFBsYWNlOiAke3RoaXMuY2l0eU5hbWV9YDtcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKGhlYWRlcik7XG4gICAgICAgIHZhciB0YWJsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RhYmxlJyk7XG4gICAgICAgIHRhYmxlLmNsYXNzTmFtZSA9ICd3ZWF0aGVyVGFibGUgdGFibGUnO1xuICAgICAgICB2YXIgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuICAgICAgICB2YXIgdGhIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xuICAgICAgICB0aEhlYWRlci5pbm5lckhUTUwgPSAnRGF0ZSc7XG4gICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgdHIuYXBwZW5kQ2hpbGQodGhIZWFkZXIpO1xuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgNzsgaW5kZXgrKykge1xuICAgICAgICAgICAgdmFyIHRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTtcbiAgICAgICAgICAgIHRoLmlubmVySFRNTCA9IGAke2RhdGUuZ2V0RGF0ZSgpfS4ke2RhdGUuZ2V0TW9udGgoKSsxfWA7XG4gICAgICAgICAgICB0ci5hcHBlbmRDaGlsZCh0aCk7XG4gICAgICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyAxKTtcbiAgICAgICAgfVxuICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0cik7XG5cbiAgICAgICAgdHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuICAgICAgICB2YXIgdGRIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0aCcpO1xuICAgICAgICB0ci5hcHBlbmRDaGlsZCh0ZEhlYWRlcik7XG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCA3OyBpbmRleCsrKSB7XG4gICAgICAgICAgICB2YXIgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgICAgICAgdGQuaW5uZXJIVE1MID0gYDxjYW52YXMgY2xhc3M9XCIke2RhaWx5Rm9yZWNhc3RbaW5kZXhdLmljb259XCIgd2lkdGg9XCIzMFwiIGhlaWdodD1cIjMwXCI+PC9jYW52YXM+YFxuICAgICAgICAgICAgdHIuYXBwZW5kQ2hpbGQodGQpO1xuICAgICAgICB9XG4gICAgICAgIHRhYmxlLmFwcGVuZENoaWxkKHRyKTtcblxuICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVJvdyhkYWlseUZvcmVjYXN0LCAnRGF5IHRlbXBlcmF0dXJlJywgJ3RlbXBlcmF0dXJlSGlnaCcpKTtcbiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGhpcy5jcmVhdGVSb3coZGFpbHlGb3JlY2FzdCwgJ05pZ2h0IHRlbXBlcmF0dXJlJywgJ3RlbXBlcmF0dXJlTG93JykpO1xuICAgICAgICB0YWJsZS5hcHBlbmRDaGlsZCh0aGlzLmNyZWF0ZVJvdyhkYWlseUZvcmVjYXN0LCAnV2luZCBzcGVlZCcsICd3aW5kU3BlZWQnKSk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZENoaWxkKHRhYmxlKTtcbiAgICAgICAgdXBkYXRlSWNvbnMoKTtcbiAgICB9XG5cbiAgICBjcmVhdGVSb3coc291cmNlLCByb3dIZWFkZXIsIHJvd0NvbnRlbnQpIHtcbiAgICAgICAgdmFyIHRyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcbiAgICAgICAgdmFyIHRkSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGgnKTtcbiAgICAgICAgdGRIZWFkZXIuaW5uZXJIVE1MID0gcm93SGVhZGVyO1xuICAgICAgICB0ci5hcHBlbmRDaGlsZCh0ZEhlYWRlcik7XG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCA3OyBpbmRleCsrKSB7XG4gICAgICAgICAgICB2YXIgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgICAgICAgdGQuaW5uZXJIVE1MID0gc291cmNlW2luZGV4XVtyb3dDb250ZW50XTtcbiAgICAgICAgICAgIHRyLmFwcGVuZENoaWxkKHRkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHI7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBXZWF0aGVyRm9yZWNhc3Q7IiwiaW1wb3J0IGRlYm91bmNlIGZyb20gJy4uL3V0aWxzL2RlYm91bmNlJztcbmltcG9ydCBpU3RvcmFnZSBmcm9tICcuLi91dGlscy9sc1N0b3JhZ2UnO1xuXG5mdW5jdGlvbiBldkhhbmRsZXIoZXYpIHtcbiAgICB2YXIgY29vcmRzID0gbXlNYXAuZ2V0Q2VudGVyKCk7XG4gICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKCdtYXA6bW92ZWQnLCBjb29yZHNbMF0sIGNvb3Jkc1sxXSk7XG59XG5cblxuXG52YXIgbXlNYXA7XG52YXIgcGxhY2VtYXJrcyA9IHt9O1xuXG5mdW5jdGlvbiBZYW5kZXhNYXAoZXZlbnRCdXMsIGxhdCwgbG5nLCBzdG9yYWdlTmFtZSkge1xuICAgIHRoaXMuc3RhcnRMYXQgPSBsYXQ7XG4gICAgdGhpcy5zdGFydExuZyA9IGxuZztcbiAgICB0aGlzLmV2ZW50QnVzID0gZXZlbnRCdXM7XG4gICAgdGhpcy5zdG9yYWdlTmFtZSA9IHN0b3JhZ2VOYW1lO1xuICAgIHRoaXMuaW5pdCgpO1xuXG59O1xuXG5ZYW5kZXhNYXAucHJvdG90eXBlLm1vdmVUbyA9IGZ1bmN0aW9uKGxhdCwgbG5nKSB7XG4gICAgbXlNYXAucGFuVG8oWytsYXQsICtsbmddLCB7IGR1cmF0aW9uOiAyMDAwIH0pO1xufVxuXG5ZYW5kZXhNYXAucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcbiAgICB5bWFwcy5yZWFkeSgoKSA9PiB7XG4gICAgICAgIHRoaXMuY3JlYXRlTWFwKFt0aGlzLnN0YXJ0TGF0LCB0aGlzLnN0YXJ0TG5nXSk7XG5cbiAgICAgICAgaVN0b3JhZ2UuZ2V0RGF0YSh0aGlzLnN0b3JhZ2VOYW1lKS50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gSlNPTi5wYXJzZShkYXRhKSB8fCB7fTtcbiAgICAgICAgICAgIGZvciAobGV0IGtleSBpbiBpdGVtcykge1xuICAgICAgICAgICAgICAgIGxldCBteVBsYWNlbWFyayA9IG5ldyB5bWFwcy5QbGFjZW1hcmsoW2l0ZW1zW2tleV1bJ2xhdCddLCBpdGVtc1trZXldWydsbmcnXV0sIHt9LCB7XG4gICAgICAgICAgICAgICAgICAgIHByZXNldDogJ2lzbGFuZHMjeWVsbG93R2x5cGhJY29uJyxcbiAgICAgICAgICAgICAgICAgICAgaWNvbkdseXBoOiAnc3RhcidcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBwbGFjZW1hcmtzW2Ake2l0ZW1zW2tleV1bJ2xhdCddfSwkeyBpdGVtc1trZXldWydsbmcnXX1gXSA9IG15UGxhY2VtYXJrO1xuICAgICAgICAgICAgICAgIG15TWFwLmdlb09iamVjdHMuYWRkKG15UGxhY2VtYXJrKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9KVxuXG4gICAgICAgIHRoaXMuZXZlbnRCdXMub24oJ2xpc3Q6YWRkRmF2JywgKGNvb3JkcykgPT4ge1xuICAgICAgICAgICAgbGV0IG15UGxhY2VtYXJrID0gbmV3IHltYXBzLlBsYWNlbWFyayhbY29vcmRzWydsYXQnXSwgY29vcmRzWydsbmcnXV0sIHt9LCB7XG4gICAgICAgICAgICAgICAgcHJlc2V0OiAnaXNsYW5kcyN5ZWxsb3dHbHlwaEljb24nLFxuICAgICAgICAgICAgICAgIGljb25HbHlwaDogJ3N0YXInXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHBsYWNlbWFya3NbYCR7Y29vcmRzWydsYXQnXX0sJHtjb29yZHNbJ2xuZyddfWBdID0gbXlQbGFjZW1hcms7XG4gICAgICAgICAgICBteU1hcC5nZW9PYmplY3RzLmFkZChteVBsYWNlbWFyayk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgdGhpcy5ldmVudEJ1cy5vbignbGlzdDpyZW1vdmVGYXYnLCAoY29vcmRzKSA9PiB7XG4gICAgICAgICAgICBteU1hcC5nZW9PYmplY3RzLnJlbW92ZShwbGFjZW1hcmtzW2Ake2Nvb3Jkc1snbGF0J119LCR7Y29vcmRzWydsbmcnXX1gXSk7XG4gICAgICAgICAgICBkZWxldGUgcGxhY2VtYXJrc1tgJHtjb29yZHNbJ2xhdCddfSwke2Nvb3Jkc1snbG5nJ119YF07XG4gICAgICAgIH0pXG4gICAgfSk7XG5cbn1cblxuWWFuZGV4TWFwLnByb3RvdHlwZS5jcmVhdGVNYXAgPSBmdW5jdGlvbihjb29yZHMpIHtcblxuICAgIG15TWFwID0gbmV3IHltYXBzLk1hcCgnbWFwJywge1xuICAgICAgICBjZW50ZXI6IFtjb29yZHNbMF0sIGNvb3Jkc1sxXV0sXG4gICAgICAgIHpvb206IDEyLFxuICAgICAgICBjb250cm9sczogWyd6b29tQ29udHJvbCddXG4gICAgfSwge1xuICAgICAgICBzdXBwcmVzc01hcE9wZW5CbG9jazogdHJ1ZVxuICAgIH0pO1xuXG4gICAgbXlNYXAuZXZlbnRzLmFkZCgnY2xpY2snLCAoZSkgPT4ge1xuXG4gICAgICAgIHZhciBjb29yZHMgPSBlLmdldCgnY29vcmRzJyk7XG4gICAgICAgIC8vIHZhciBteVBsYWNlbWFyayA9IG5ldyB5bWFwcy5QbGFjZW1hcmsoW2Nvb3Jkc1swXSwgY29vcmRzWzFdXSwge30sIHtcbiAgICAgICAgLy8gICAgIHByZXNldDogJ2lzbGFuZHMjeWVsbG93R2x5cGhJY29uJyxcbiAgICAgICAgLy8gICAgIGljb25HbHlwaDogJ3N0YXInXG4gICAgICAgIC8vIH0pO1xuXG4gICAgICAgIC8vIG15TWFwLmdlb09iamVjdHMuYWRkKG15UGxhY2VtYXJrKTtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIGxhdDogY29vcmRzWzBdLFxuICAgICAgICAgICAgbG5nOiBjb29yZHNbMV1cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ldmVudEJ1cy50cmlnZ2VyKCdtYXA6Y2xpY2tlZCcsIG9iaik7XG4gICAgfSk7XG5cbiAgICBteU1hcC5ldmVudHMuYWRkKCdhY3Rpb25lbmQnLCBkZWJvdW5jZShldkhhbmRsZXIsIDcwMCkuYmluZCh0aGlzKSlcbn1cblxuWWFuZGV4TWFwLnByb3RvdHlwZS5nZXRDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbXlNYXAuZ2V0Q2VudGVyKCk7XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgWWFuZGV4TWFwOyIsImltcG9ydCByb3V0ZXMgZnJvbSAnLi9yb3V0ZXMnO1xuaW1wb3J0IFJvdXRlciBmcm9tICcuL3V0aWxzL3JvdXRlcic7XG5cblxudmFyIHJvdXRlciA9IG5ldyBSb3V0ZXIocm91dGVzKTsiLCJpbXBvcnQgTGlzdENvbXBvbmVudCBmcm9tICcuL2NvbXBvbmVudHMvbGlzdENvbXBvbmVudCc7XG5pbXBvcnQgR29vZ2xlTWFwIGZyb20gJy4vY29tcG9uZW50cy9nb29nbGVTZWFyY2gnO1xuaW1wb3J0IFlhbmRleE1hcCBmcm9tICcuL2NvbXBvbmVudHMveWFuZGV4TWFwJztcbmltcG9ydCBXZWF0aGVyRm9yZWNhc3QgZnJvbSAnLi9jb21wb25lbnRzL3dlYXRoZXJGb3JlY2FzdCc7XG5pbXBvcnQgRXZlbnRCdXMgZnJvbSAnLi91dGlscy9ldmVudEJ1cyc7XG5pbXBvcnQgd2VhdGhlckZvcmVjYXN0IGZyb20gJy4vY29tcG9uZW50cy93ZWF0aGVyRm9yZWNhc3QnO1xuaW1wb3J0IHVzZXJMb2NhdGlvbiBmcm9tICcuL3V0aWxzL3VzZXJMb2NhdGlvbic7XG5pbXBvcnQgcmVxdWVzdCBmcm9tICcuL3V0aWxzL3JlcXVlc3QnO1xuaW1wb3J0IENpdHlJbnB1dCBmcm9tICcuL2NvbXBvbmVudHMvc2VhcmNoQ29tcG9uZW50JztcblxudmFyIHJhZGlvID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm15cmFkaW8nKTtcbnJhZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXYgPT4ge1xuICAgIHJlcXVlc3QudHlwZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJyZXF1ZXN0X19vcHRpb25cIl06Y2hlY2tlZCcpLnZhbHVlO1xufSlcblxubGV0IGV2ZW50QnVzO1xubGV0IGdvb2dsZU1hcDtcbmxldCB5YW5kZXhNYXA7XG5sZXQgZmF2b3JpdGVzO1xubGV0IGhpc3Rvcnk7XG5sZXQgd2VhdGhlcjtcbmxldCBjaXR5SW5wdXQ7XG5cbmxldCBtYWluSHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNtYXAnKTtcbmxldCB3ZWF0aGVySHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyN3ZWF0aGVyJyk7XG5cbmxldCByb3V0ZXMgPSBbe1xuICAgICAgICBtYXRjaDogJycsXG4gICAgICAgIG9uRW50ZXI6ICgpID0+IHtcbiAgICAgICAgICAgIHVzZXJMb2NhdGlvblxuICAgICAgICAgICAgICAgIC50aGVuKChwb3NpdGlvbikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IGAke3Bvc2l0aW9uLmxhdGl0dWRlfSwke3Bvc2l0aW9uLmxvbmdpdHVkZX1gXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHtcbiAgICAgICAgbWF0Y2g6IC9jaXR5PSguKykvLFxuICAgICAgICBvbkVudGVyOiAoY2l0eSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFjaGVja1Jlc291cmNlcygpKSB7XG4gICAgICAgICAgICAgICAgaW5pdChjaXR5KTtcbiAgICAgICAgICAgICAgICBoaXN0b3J5LmFkZEl0ZW0oZGVjb2RlVVJJKGNpdHkpKTtcbiAgICAgICAgICAgICAgICBnb29nbGVNYXAuZ2V0TGF0TG5nKGNpdHkpLnRoZW4oZGF0YSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBgJHtkYXRhWydsYXQnXX0sJHtkYXRhWydsbmcnXX1gO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhpc3RvcnkuYWRkSXRlbShkZWNvZGVVUkkoY2l0eSkpO1xuICAgICAgICAgICAgICAgIGdvb2dsZU1hcC5nZXRMYXRMbmcoY2l0eSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlhbmRleE1hcC5tb3ZlVG8oZGF0YVsnbGF0J10sIGRhdGFbJ2xuZyddKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfSwge1xuXG4gICAgICAgIG1hdGNoOiAvXihbK3wtXT9cXGQqXFwuP1xcZCspXFwsKFsrfC1dP1xcZCpcXC4/XFxkKykvLFxuICAgICAgICBvbkVudGVyOiAoY29vcmQpID0+IHtcblxuICAgICAgICAgICAgaWYgKCFjaGVja1Jlc291cmNlcygpKSB7XG4gICAgICAgICAgICAgICAgaW5pdCguLi5jb29yZCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZ29vZ2xlTWFwLmdldFBsYWNlTmFtZSguLi5jb29yZCkudGhlbihcbiAgICAgICAgICAgICAgICBjaXR5TmFtZSA9PiB3ZWF0aGVyLmdldEZvcmVjYXN0QnlMYXRMbmcoLi4uY29vcmQsIGNpdHlOYW1lKVxuICAgICAgICAgICAgKS5jYXRjaChlcnIgPT4gd2VhdGhlci5nZXRGb3JlY2FzdEJ5TGF0TG5nKC4uLmNvb3JkLCAnVW5rbm93biBwbGFjZScpKVxuXG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIG1hdGNoOiAvY2VudGVyPShbK3wtXT9cXGQqXFwuP1xcZCspXFwsKFsrfC1dP1xcZCpcXC4/XFxkKykvLFxuICAgICAgICBvbkJlZm9yZUVudGVyOiAoY29vcmQpID0+IGNoZWNrUmVzb3VyY2VzKCkgPyB5YW5kZXhNYXAubW92ZVRvKC4uLmNvb3JkKSA6IGluaXQoLi4uY29vcmQpXG4gICAgfSxcblxuICAgIHtcbiAgICAgICAgbWF0Y2g6ICdhdXRob3InLFxuICAgICAgICBvbkVudGVyOiAoKSA9PiB7XG4gICAgICAgICAgICBjbGVhclJlc291cmNlcygpO1xuICAgICAgICAgICAgd2VhdGhlckh0bWwuaGlkZGVuID0gJ3RydWUnO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjdGl2ZScpLmNsYXNzTmFtZSA9ICcnO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2hyZWY9XCIjYXV0aG9yXCJdJykucGFyZW50RWxlbWVudC5jbGFzc05hbWUgPSAnYWN0aXZlJztcbiAgICAgICAgICAgIG1haW5IdG1sLmlubmVySFRNTCA9IFwiPGgyPkF1dGhvciAtIEthdGUgS3V6a2luYTwvaDI+XCI7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIG1hdGNoOiAnYWJvdXQnLFxuICAgICAgICBvbkVudGVyOiAoKSA9PiB7XG4gICAgICAgICAgICBjbGVhclJlc291cmNlcygpO1xuICAgICAgICAgICAgd2VhdGhlckh0bWwuaGlkZGVuID0gJ3RydWUnO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjdGl2ZScpLmNsYXNzTmFtZSA9ICcnO1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignW2hyZWY9XCIjYWJvdXRcIl0nKS5wYXJlbnRFbGVtZW50LmNsYXNzTmFtZSA9ICdhY3RpdmUnO1xuICAgICAgICAgICAgbWFpbkh0bWwuaW5uZXJIVE1MID0gXCI8aDI+V2V6emFyZCBpcyB0aGUgYmVzdCB3ZWF0aGVyIHNpdGUgZXZlcjwvaDI+XCI7XG4gICAgICAgIH1cbiAgICB9XG5cbl07XG5cbmZ1bmN0aW9uIGNoZWNrUmVzb3VyY2VzKCkge1xuICAgIHJldHVybiBoaXN0b3J5ICYmIGdvb2dsZU1hcCAmJiB5YW5kZXhNYXAgJiYgd2VhdGhlciA/IHRydWUgOiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gY2xlYXJSZXNvdXJjZXMoKSB7XG5cbiAgICBldmVudEJ1cyA9IG51bGw7XG4gICAgZ29vZ2xlTWFwID0gbnVsbDtcbiAgICB5YW5kZXhNYXAgPSBudWxsO1xuICAgIGZhdm9yaXRlcyA9IG51bGw7XG4gICAgaGlzdG9yeSA9IG51bGw7XG4gICAgd2VhdGhlciA9IG51bGw7XG4gICAgY2l0eUlucHV0ID0gbnVsbDtcblxufVxuXG5mdW5jdGlvbiBpbml0KGxhdCwgbG5nKSB7XG4gICAgd2VhdGhlckh0bWwucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICBtYWluSHRtbC5pbm5lckhUTUwgPSAnJztcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWN0aXZlJykuY2xhc3NOYW1lID0gJyc7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbGkgW2hyZWY9XCIjXCJdJykucGFyZW50RWxlbWVudC5jbGFzc05hbWUgPSAnYWN0aXZlJztcbiAgICBldmVudEJ1cyA9IG5ldyBFdmVudEJ1cygpO1xuICAgIGdvb2dsZU1hcCA9IG5ldyBHb29nbGVNYXAoZXZlbnRCdXMpO1xuICAgIGlmIChOdW1iZXIuaXNOYU4oK2xhdCkpIHtcbiAgICAgICAgZ29vZ2xlTWFwLmdldExhdExuZyhsYXQpXG4gICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHlhbmRleE1hcCA9IG5ldyBZYW5kZXhNYXAoZXZlbnRCdXMsIGRhdGFbJ2xhdCddLCBkYXRhWydsbmcnXSwgJ0Zhdm9yaXRlcycpO1xuICAgICAgICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgICB5YW5kZXhNYXAgPSBuZXcgWWFuZGV4TWFwKGV2ZW50QnVzLCBsYXQsIGxuZywgJ0Zhdm9yaXRlcycpO1xuICAgIH1cblxuXG4gICAgZmF2b3JpdGVzID0gbmV3IExpc3RDb21wb25lbnQodHJ1ZSwgMCwgJ0Zhdm9yaXRlcycsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mYXZvcml0ZXNfX2xpc3QnKSwgZXZlbnRCdXMpO1xuICAgIGhpc3RvcnkgPSBuZXcgTGlzdENvbXBvbmVudChmYWxzZSwgNSwgJ0hpc3RvcnknLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGlzdG9yeV9fbGlzdCcpKTtcbiAgICB3ZWF0aGVyID0gbmV3IFdlYXRoZXJGb3JlY2FzdChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud2VhdGhlcl9fZm9yZWNhc3QnKSwgZXZlbnRCdXMpO1xuICAgIGNpdHlJbnB1dCA9IG5ldyBDaXR5SW5wdXQoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmlucHV0LWdyb3VwJyksIGV2ZW50QnVzKTtcblxuXG4gICAgZXZlbnRCdXMub24oJ3NlYXJjaDpjaXR5JywgKGNpdHkpID0+IHtcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBgY2l0eT0ke2NpdHl9YDtcbiAgICB9KTtcblxuICAgIGV2ZW50QnVzLm9uKCdtYXA6bW92ZWQnLCAobGF0LCBsbmcpID0+IHtcblxuICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IGAke2xhdH0sJHtsbmd9YDtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcm91dGVzOyIsImZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIGRlbGF5KSB7XG4gICAgdmFyIHRpbWVySUQ7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHM7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lcklEKTtcbiAgICAgICAgdGltZXJJRCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gZnVuYy5hcHBseShzZWxmLCBwYXJhbXMpO1xuICAgICAgICB9LCBkZWxheSk7XG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBkZWJvdW5jZTsiLCIvKipcbiAq0KTRg9C90LrRhtC40Y8gRXZlbnRCdXMg0LTQu9GPINC+0LHQvNC10L3QsCDRgdC+0L7QsdGJ0LXQvdC40Y/QvNC4XG4gKi9cbmZ1bmN0aW9uIEV2ZW50QnVzKCkge1xuICAgIHRoaXMubGlzdGVuZXJzID0ge307XG59XG5cbi8qKlxuICrQpNGD0L3QutGG0LjRjyB0cmlnZ2VyINC00LvRjyDQstGL0LfQvtCy0LAg0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINGB0L7QsdGL0YLQuNGPXG4gKkBwYXJhbSBldmVudCAgINGB0L7QsdGL0YLQuNC1LCDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC60L7RgtC+0YDQvtCz0L4g0L3QtdC+0LHRhdC+0LTQuNC80L4g0LLRi9C30LLQsNGC0YxcbiAqL1xuRXZlbnRCdXMucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbihldmVudCkge1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAodGhpcy5saXN0ZW5lcnNbZXZlbnRdIHx8IFtdKS5sZW5ndGg7IGkrKykge1xuICAgICAgICB2YXIgY2IgPSB0aGlzLmxpc3RlbmVyc1tldmVudF1baV07XG4gICAgICAgIGlmICh0eXBlb2YoY2IpID09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICAgICAgICBjYi5hcHBseShudWxsLCBwYXJhbXMpO1xuICAgICAgICAgICAgaWYgKGNiLnRvU3RyaW5nKCkuaW5kZXhPZignc2VsZi5vZmYnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBpLS07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qKlxuICrQpNGD0L3QutGG0LjRjyBvbiDQtNC70Y8g0LTQvtCx0LDQstC70LXQvdC40Y8g0L7QsdGA0LDQsdC+0YLRh9C40LrQvtCyINGB0L7QsdGL0YLQuNGPXG4gKkBwYXJhbSBldmVudCAgINGB0L7QsdGL0YLQuNC1LCDQvtCx0YDQsNCx0L7RgtGH0LjQutC4INC60L7RgtC+0YDQvtCz0L4g0L3QtdC+0LHRhdC+0LTQuNC80L4g0LTQvtCx0LDQstC40YLRjFxuICpAcGFyYW0gY2IgICAgICDQvtCx0YDQsNCx0L7RgtGH0LjQuiDRgdC+0LHRi9GC0LjRjyBldmVudFxuICovXG5FdmVudEJ1cy5wcm90b3R5cGUub24gPSBmdW5jdGlvbihldmVudCwgY2IpIHtcblxuICAgIHRoaXMubGlzdGVuZXJzW2V2ZW50XSA9ICh0aGlzLmxpc3RlbmVyc1tldmVudF0gfHwgW10pO1xuICAgIHRoaXMubGlzdGVuZXJzW2V2ZW50XS5wdXNoKGNiKTtcbn1cblxuLyoqXG4gKtCk0YPQvdC60YbQuNGPIG9uINC00LvRjyDRg9C00LDQu9C10L3QuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC60L7QsiDRgdC+0LHRi9GC0LjRj1xuICpAcGFyYW0gZXZlbnQgICDRgdC+0LHRi9GC0LjQtSwg0L7QsdGA0LDQsdC+0YLRh9C40LrQuCDQutC+0YLQvtGA0L7Qs9C+INC90LXQvtCx0YXQvtC00LjQvNC+INGD0LTQsNC70LjRgtGMXG4gKkBwYXJhbSBjYiAgICAgINC+0LHRgNCw0LHQvtGC0YfQuNC6INGB0L7QsdGL0YLQuNGPIGV2ZW50XG4gKi9cbkV2ZW50QnVzLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihldmVudCwgY2IpIHtcblxuICAgIGlmICh0aGlzLmxpc3RlbmVyc1tldmVudF0gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHBvc2l0aW9uID0gdGhpcy5saXN0ZW5lcnNbZXZlbnRdLmluZGV4T2YoY2IpO1xuICAgIHRoaXMubGlzdGVuZXJzW2V2ZW50XS5zcGxpY2UocG9zaXRpb24sIDEpO1xufVxuXG4vKipcbiAq0KTRg9C90LrRhtC40Y8gb24g0LTQu9GPINC00L7QsdCw0LLQu9C10L3QuNGPINC+0LHRgNCw0LHQvtGC0YfQuNC60LAg0YHQvtCx0YvRgtC40Y8sINC60L7RgtC+0YDRi9C5INGB0YDQsNCx0L7RgtCw0LXRgiAxINGA0LDQt1xuICpAcGFyYW0gZXZlbnQgICDRgdC+0LHRi9GC0LjQtSwg0L7QsdGA0LDQsdC+0YLRh9C40Log0LrQvtGC0L7RgNC+0LPQviDQvdC10L7QsdGF0L7QtNC40LzQviDQtNC+0LHQsNCy0LjRgtGMXG4gKkBwYXJhbSBjYiAgICAgINC+0LHRgNCw0LHQvtGC0YfQuNC6INGB0L7QsdGL0YLQuNGPIGV2ZW50XG4gKi9cbkV2ZW50QnVzLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24oZXZlbnQsIGNiKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgZnVuY3Rpb24gZnVuY3Rpb25Ub09mZigpIHtcbiAgICAgICAgY2IuYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcbiAgICAgICAgc2VsZi5vZmYoZXZlbnQsIGZ1bmN0aW9uVG9PZmYpO1xuICAgIH07XG5cbiAgICBzZWxmLm9uKGV2ZW50LCBmdW5jdGlvblRvT2ZmKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgRXZlbnRCdXM7IiwidmFyIGxzU3RvcmFnZSA9IHtcbiAgICBnZXREYXRhOiAoa2V5KSA9PiBQcm9taXNlLnJlc29sdmUod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSkpLFxuICAgIHNldERhdGE6IChrZXksIHZhbHVlKSA9PiBQcm9taXNlLnJlc29sdmUod2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKGtleSwgdmFsdWUpKVxufTtcblxuZXhwb3J0IGRlZmF1bHQgbHNTdG9yYWdlOyIsImZ1bmN0aW9uIHJlcXVlc3QodXJsKSB7XG4gICAgcmV0dXJuIChyZXF1ZXN0LnR5cGUgPT09ICdYSFInID8gbWFrZVJlcXVlc3RYSFIodXJsKSA6IG1ha2VSZXF1ZXN0RmV0Y2godXJsKSlcbn07XG5cbnJlcXVlc3QudHlwZSA9ICdYSFInO1xuXG5mdW5jdGlvbiBtYWtlUmVxdWVzdEZldGNoKHVybCkge1xuICAgIHJldHVybiBmZXRjaCh1cmwpXG4gICAgICAgIC50aGVuKChyZXEpID0+IHJlcS5qc29uKCkpXG59O1xuXG5mdW5jdGlvbiBtYWtlUmVxdWVzdFhIUih1cmwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDApIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlKEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlamVjdCh7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogdGhpcy5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHhoci5zdGF0dXNUZXh0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZWplY3Qoe1xuICAgICAgICAgICAgICAgIHN0YXR1czogdGhpcy5zdGF0dXMsXG4gICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogeGhyLnN0YXR1c1RleHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICB4aHIuc2VuZCgpO1xuICAgIH0pO1xufVxuXG5leHBvcnQgZGVmYXVsdCByZXF1ZXN0OyIsIi8qKlxuICog0KTRg9C90LrRhtC40Y8g0LTQu9GPINC00L7QsdCw0LLQu9C10L3QuNGPINC4INC+0LHRgNCw0LHQvtGC0LrQuCDRgNC+0YPRgtC+0LIg0L3QsCDRgdGC0YDQsNC90LjRhtC1XG4gKiBAcGFyYW0geyp9IHJvdXRlUGFyYW1zINC80LDRgdGB0LjQsiDQv9Cw0YDQsNC80LXRgtGA0L7QsiDQtNC70Y8g0L7QsdGA0LDQsdC+0YLQutC4INGA0L7Rg9GC0L7QslxuICovXG5mdW5jdGlvbiBSb3V0ZXIocm91dGVQYXJhbXMpIHtcbiAgICB0aGlzLnJvdXRlcyA9IHJvdXRlUGFyYW1zIHx8IFtdO1xuICAgIHRoaXMuY3VycmVudFJvdXRlO1xuICAgIHRoaXMucHJldmlvdXNSb3V0ZTtcbiAgICB0aGlzLmN1cnJlbnRQYXJhbXM7XG4gICAgdGhpcy5wcmV2aW91c1BhcmFtcztcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIChldmVudCkgPT4ge1xuICAgICAgICB0aGlzLmhhbmRsZXIod2luZG93LmxvY2F0aW9uLmhhc2gpO1xuICAgIH0pXG4gICAgdGhpcy5oYW5kbGVyKHdpbmRvdy5sb2NhdGlvbi5oYXNoKTtcbn1cblxuUm91dGVyLnByb3RvdHlwZSA9IHtcbiAgICBoYW5kbGVyOiBmdW5jdGlvbihoYXNoKSB7XG4gICAgICAgIHRoaXMucHJldmlvdXNSb3V0ZSA9IHRoaXMuY3VycmVudFJvdXRlO1xuICAgICAgICB0aGlzLnByZXZpb3VzUGFyYW1zID0gdGhpcy5jdXJyZW50UGFyYW1zO1xuICAgICAgICB0aGlzLmN1cnJlbnRSb3V0ZSA9IHRoaXMuZmluZE5ld1JvdXRlKGhhc2gpO1xuICAgICAgICB0aGlzLmxhdW5jaEhhbmRsZXJzKCk7XG4gICAgfSxcbiAgICBmaW5kTmV3Um91dGU6IGZ1bmN0aW9uKGhhc2gpIHtcbiAgICAgICAgaGFzaCA9IGhhc2guc2xpY2UoMSk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnJvdXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLnJvdXRlc1tpXTtcbiAgICAgICAgICAgIGlmICh0eXBlb2YoZWxlbWVudC5tYXRjaCkgPT0gXCJzdHJpbmdcIiAmJiBlbGVtZW50Lm1hdGNoID09PSBoYXNoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gJyc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mKGVsZW1lbnQubWF0Y2gpID09IFwiZnVuY3Rpb25cIiAmJiBlbGVtZW50Lm1hdGNoKGhhc2gpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gJyc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGVsZW1lbnQubWF0Y2ggaW5zdGFuY2VvZiBSZWdFeHApICYmIGVsZW1lbnQubWF0Y2gudGVzdChoYXNoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBhcmFtcyA9IGhhc2gubWF0Y2goZWxlbWVudC5tYXRjaCkgfHwgW107XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zLnNwbGljZSgwLCAxKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sXG4gICAgbGF1bmNoSGFuZGxlcnMoKSB7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7IHRoaXMucHJldmlvdXNSb3V0ZSAmJiB0aGlzLnByZXZpb3VzUm91dGUub25MZWF2ZSAmJiB0aGlzLnByZXZpb3VzUm91dGUub25MZWF2ZSh0aGlzLnByZXZpb3VzUGFyYW1zKSB9KVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4geyB0aGlzLmN1cnJlbnRSb3V0ZSAmJiB0aGlzLmN1cnJlbnRSb3V0ZS5vbkJlZm9yZUVudGVyICYmIHRoaXMuY3VycmVudFJvdXRlLm9uQmVmb3JlRW50ZXIodGhpcy5jdXJyZW50UGFyYW1zKSB9KVxuICAgICAgICAgICAgLnRoZW4oKCkgPT4geyB0aGlzLmN1cnJlbnRSb3V0ZSAmJiB0aGlzLmN1cnJlbnRSb3V0ZS5vbkVudGVyICYmIHRoaXMuY3VycmVudFJvdXRlLm9uRW50ZXIodGhpcy5jdXJyZW50UGFyYW1zKSB9KTtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFJvdXRlcjsiLCJ2YXIgc2t5Y29ucyA9IG5ldyBTa3ljb25zKCk7XG5cbmZ1bmN0aW9uIHNldEljb25zKCkge1xuXG4gICAgdmFyIGljb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnY2FudmFzJyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpY29ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICBza3ljb25zLmFkZChpY29uc1tpXSwgU2t5Y29uc1tpY29uc1tpXS5jbGFzc05hbWUudG9VcHBlckNhc2UoKS5yZXBsYWNlKC8tL2csIFwiX1wiKV0pO1xuICAgIH1cblxuICAgIHNreWNvbnMucGxheSgpO1xufTtcbnNldEljb25zKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVwZGF0ZUljb25zKCkge1xuICAgIHZhciBpY29ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2NhbnZhcycpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWNvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc2t5Y29ucy5zZXQoaWNvbnNbaV0sIFNreWNvbnNbaWNvbnNbaV0uY2xhc3NOYW1lLnRvVXBwZXJDYXNlKCkucmVwbGFjZSgvLS9nLCBcIl9cIildKTtcbiAgICB9XG59IiwiaW1wb3J0IHJlcXVlc3QgZnJvbSAnLi9yZXF1ZXN0JztcblxudmFyIHVzZXJMb2NhdGlvbiA9IHJlcXVlc3QoJ2h0dHBzOi8vYXBpLnVzZXJpbmZvLmlvL3VzZXJpbmZvcycpLnRoZW4oZGF0YSA9PiBkYXRhLnBvc2l0aW9uKVxuXG5cbmV4cG9ydCBkZWZhdWx0IHVzZXJMb2NhdGlvbjsiXX0=
